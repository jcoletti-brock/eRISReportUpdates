[{"item":"{\n  \"name\" : \"KWCRH.KWCR_HEPTWL1TT.F_CV_PREP\",\n  \"description\" : \"HD1 HD2 Classic Historian Totalizer Prep\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_HEPTWL1TT.F_CV:sample:PT2M\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCRH.KWCR_HEPTWL1TT.F_CV_PREP\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCRH.KWCR_HEPTWL1TT.F_CV_PREP\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.766\",\n  \"modified\" : \"2019-12-10T17:02:59.767\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Classic Historian Totalizer Prep Rule\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"KWCRH.KWCR_KIWK050TT.F_CV:sample:PT2M\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Initialize local variable prevValue with the first value in the input array\\nBigDecimal prevValue = __source__.first;\\n//Iterate through each element of the input array\\nforeach(element:__source__.array){\\n    //If the value of the array element is less than 1\\n    if(element.value<1){\\n        //Set the quality of the element to 0\\n        element.quality=0;\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //If the difference between the current value and the previous value\\n    //is greater than 500\\n    if((element.value - prevValue)>500 || (element.value-prevValue<-500)){\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //Set the value of prevValue to the current element value\\n    prevValue = element.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCRH.KWCR_HEPTWL1TT.F_CV\",\n  \"description\" : \"HD1 HD2 Daily Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"@.KWCRH.KWCR_HEPTWL1TT.F_CV_PREP:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"HD1HD2MaxFlow\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCRH.KWCR_HEPTWL1TT.F_CV\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCRH.KWCR_HEPTWL1TT.F_CV\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.768\",\n  \"modified\" : \"2019-12-10T17:02:59.769\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCRH.KWCR_CGSCNB0TT.F_CV_PREP\",\n  \"description\" : \"C5 C6 Classic Historian Totalizer Prep\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_CGSCNB0TT.F_CV:sample:PT2M\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCRH.KWCR_CGSCNB0TT.F_CV_PREP\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCRH.KWCR_CGSCNB0TT.F_CV_PREP\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.770\",\n  \"modified\" : \"2019-12-10T17:02:59.771\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Classic Historian Totalizer Prep Rule\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"KWCRH.KWCR_KIWK050TT.F_CV:sample:PT2M\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Initialize local variable prevValue with the first value in the input array\\nBigDecimal prevValue = __source__.first;\\n//Iterate through each element of the input array\\nforeach(element:__source__.array){\\n    //If the value of the array element is less than 1\\n    if(element.value<1){\\n        //Set the quality of the element to 0\\n        element.quality=0;\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //If the difference between the current value and the previous value\\n    //is greater than 500\\n    if((element.value - prevValue)>500 || (element.value-prevValue<-500)){\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //Set the value of prevValue to the current element value\\n    prevValue = element.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCRH.KWCR_CGSCNB0TT.F_CV\",\n  \"description\" : \"C5 C6 Daily Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"@.KWCRH.KWCR_CGSCNB0TT.F_CV_PREP:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"C5C6MaxFlow\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCRH.KWCR_CGSCNB0TT.F_CV\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCRH.KWCR_CGSCNB0TT.F_CV\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.773\",\n  \"modified\" : \"2019-12-10T17:02:59.774\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCRH.KWCR_CPSCNB0TT.F_CV_PREP\",\n  \"description\" : \"C3 C4 Classic Historian Totalizer Prep\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_CPSCNB0TT.F_CV:sample:PT2M\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCRH.KWCR_CPSCNB0TT.F_CV_PREP\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCRH.KWCR_CPSCNB0TT.F_CV_PREP\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.775\",\n  \"modified\" : \"2019-12-10T17:02:59.776\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Classic Historian Totalizer Prep Rule\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"KWCRH.KWCR_KIWK050TT.F_CV:sample:PT2M\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Initialize local variable prevValue with the first value in the input array\\nBigDecimal prevValue = __source__.first;\\n//Iterate through each element of the input array\\nforeach(element:__source__.array){\\n    //If the value of the array element is less than 1\\n    if(element.value<1){\\n        //Set the quality of the element to 0\\n        element.quality=0;\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //If the difference between the current value and the previous value\\n    //is greater than 500\\n    if((element.value - prevValue)>500 || (element.value-prevValue<-500)){\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //Set the value of prevValue to the current element value\\n    prevValue = element.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCRH.KWCR_CPSCNB0TT.F_CV\",\n  \"description\" : \"C3 C4 Daily Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"@.KWCRH.KWCR_CPSCNB0TT.F_CV_PREP:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"C3C4MaxFlow\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCRH.KWCR_CPSCNB0TT.F_CV\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCRH.KWCR_CPSCNB0TT.F_CV\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.777\",\n  \"modified\" : \"2019-12-10T17:02:59.778\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCRH.KWCR_WMHTWL1TT.F_CV_PREP\",\n  \"description\" : \"WM1 WM2 WM3 WM4 Classic Historian Totalizer Prep\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_WMHTWL1TT.F_CV:sample:PT2M\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCRH.KWCR_WMHTWL1TT.F_CV_PREP\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCRH.KWCR_WMHTWL1TT.F_CV_PREP\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.780\",\n  \"modified\" : \"2019-12-10T17:02:59.781\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Classic Historian Totalizer Prep Rule\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"KWCRH.KWCR_KIWK050TT.F_CV:sample:PT2M\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Initialize local variable prevValue with the first value in the input array\\nBigDecimal prevValue = __source__.first;\\n//Iterate through each element of the input array\\nforeach(element:__source__.array){\\n    //If the value of the array element is less than 1\\n    if(element.value<1){\\n        //Set the quality of the element to 0\\n        element.quality=0;\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //If the difference between the current value and the previous value\\n    //is greater than 500\\n    if((element.value - prevValue)>500 || (element.value-prevValue<-500)){\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //Set the value of prevValue to the current element value\\n    prevValue = element.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCRH.KWCR_WMHTWL1TT.F_CV\",\n  \"description\" : \"WM1 WM2 WM3 WM4 Daily Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"@.KWCRH.KWCR_WMHTWL1TT.F_CV_PREP:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"WMMaxFlow\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCRH.KWCR_WMHTWL1TT.F_CV\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCRH.KWCR_WMHTWL1TT.F_CV\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.782\",\n  \"modified\" : \"2019-12-10T17:02:59.783\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCRH.KWCR_MYPTWL1TT.F_CV_PREP\",\n  \"description\" : \"MH1 MH2 Classic Historian Totalizer Prep\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_MYPTWL1TT.F_CV:sample:PT2M\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCRH.KWCR_MYPTWL1TT.F_CV_PREP\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCRH.KWCR_MYPTWL1TT.F_CV_PREP\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.784\",\n  \"modified\" : \"2019-12-10T17:02:59.785\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Classic Historian Totalizer Prep Rule\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"KWCRH.KWCR_KIWK050TT.F_CV:sample:PT2M\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Initialize local variable prevValue with the first value in the input array\\nBigDecimal prevValue = __source__.first;\\n//Iterate through each element of the input array\\nforeach(element:__source__.array){\\n    //If the value of the array element is less than 1\\n    if(element.value<1){\\n        //Set the quality of the element to 0\\n        element.quality=0;\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //If the difference between the current value and the previous value\\n    //is greater than 500\\n    if((element.value - prevValue)>500 || (element.value-prevValue<-500)){\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //Set the value of prevValue to the current element value\\n    prevValue = element.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCRH.KWCR_MYPTWL1TT.F_CV\",\n  \"description\" : \"MH1 MH2 Daily Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"@.KWCRH.KWCR_MYPTWL1TT.F_CV_PREP:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"MH1MH2MaxFlow\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCRH.KWCR_MYPTWL1TT.F_CV\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCRH.KWCR_MYPTWL1TT.F_CV\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.786\",\n  \"modified\" : \"2019-12-10T17:02:59.788\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCRH.KWCR_MVPMHB0TT.F_CV_PREP\",\n  \"description\" : \"MH3 MH4 Classic Historian Totalizer Prep\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_MVPMHB0TT.F_CV:sample:PT2M\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCRH.KWCR_MVPMHB0TT.F_CV_PREP\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCRH.KWCR_MVPMHB0TT.F_CV_PREP\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.789\",\n  \"modified\" : \"2019-12-10T17:02:59.790\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Classic Historian Totalizer Prep Rule\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"KWCRH.KWCR_KIWK050TT.F_CV:sample:PT2M\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Initialize local variable prevValue with the first value in the input array\\nBigDecimal prevValue = __source__.first;\\n//Iterate through each element of the input array\\nforeach(element:__source__.array){\\n    //If the value of the array element is less than 1\\n    if(element.value<1){\\n        //Set the quality of the element to 0\\n        element.quality=0;\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //If the difference between the current value and the previous value\\n    //is greater than 500\\n    if((element.value - prevValue)>500 || (element.value-prevValue<-500)){\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //Set the value of prevValue to the current element value\\n    prevValue = element.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCRH.KWCR_MVPMHB0TT.F_CV\",\n  \"description\" : \"MH3 MH4 Daily Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"@.KWCRH.KWCR_MVPMHB0TT.F_CV_PREP:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"MH3MH4MaxFlow\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCRH.KWCR_MVPMHB0TT.F_CV\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCRH.KWCR_MVPMHB0TT.F_CV\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.791\",\n  \"modified\" : \"2019-12-10T17:02:59.792\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCRH.KWCR_LINTWL1TT.F_CV_PREP\",\n  \"description\" : \"L1A L2 Classic Historian Totalizer Prep\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_LINTWL1TT.F_CV:sample:PT2M\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCRH.KWCR_LINTWL1TT.F_CV_PREP\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCRH.KWCR_LINTWL1TT.F_CV_PREP\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.794\",\n  \"modified\" : \"2019-12-10T17:02:59.795\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Classic Historian Totalizer Prep Rule\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"KWCRH.KWCR_KIWK050TT.F_CV:sample:PT2M\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Initialize local variable prevValue with the first value in the input array\\nBigDecimal prevValue = __source__.first;\\n//Iterate through each element of the input array\\nforeach(element:__source__.array){\\n    //If the value of the array element is less than 1\\n    if(element.value<1){\\n        //Set the quality of the element to 0\\n        element.quality=0;\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //If the difference between the current value and the previous value\\n    //is greater than 500\\n    if((element.value - prevValue)>500 || (element.value-prevValue<-500)){\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //Set the value of prevValue to the current element value\\n    prevValue = element.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCRH.KWCR_LINTWL1TT.F_CV\",\n  \"description\" : \"L1A L2 Daily Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"@.KWCRH.KWCR_LINTWL1TT.F_CV_PREP:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"L1AL2MaxFlow\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCRH.KWCR_LINTWL1TT.F_CV\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCRH.KWCR_LINTWL1TT.F_CV\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.796\",\n  \"modified\" : \"2019-12-10T17:02:59.797\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCRH.KWCR_STCSCB0TT.F_CV_PREP\",\n  \"description\" : \"SC2 SC3 Classic Historian Totalizer Prep\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_STCSCB0TT.F_CV:sample:PT2M\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCRH.KWCR_STCSCB0TT.F_CV_PREP\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCRH.KWCR_STCSCB0TT.F_CV_PREP\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.798\",\n  \"modified\" : \"2019-12-10T17:02:59.799\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Classic Historian Totalizer Prep Rule\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"KWCRH.KWCR_KIWK050TT.F_CV:sample:PT2M\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Initialize local variable prevValue with the first value in the input array\\nBigDecimal prevValue = __source__.first;\\n//Iterate through each element of the input array\\nforeach(element:__source__.array){\\n    //If the value of the array element is less than 1\\n    if(element.value<1){\\n        //Set the quality of the element to 0\\n        element.quality=0;\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //If the difference between the current value and the previous value\\n    //is greater than 500\\n    if((element.value - prevValue)>500 || (element.value-prevValue<-500)){\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //Set the value of prevValue to the current element value\\n    prevValue = element.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCRH.KWCR_STCSCB0TT.F_CV\",\n  \"description\" : \"SC2 SC3 Daily Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"@.KWCRH.KWCR_STCSCB0TT.F_CV_PREP:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"SC2SC3MaxFlow\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCRH.KWCR_STCSCB0TT.F_CV\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCRH.KWCR_STCSCB0TT.F_CV\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.800\",\n  \"modified\" : \"2019-12-10T17:02:59.802\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCRH.KWCR_WHPWYB0TT.F_CV_PREP\",\n  \"description\" : \"WY1 WY5 Classic Historian Totalizer Prep\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_WHPWYB0TT.F_CV:sample:PT2M\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCRH.KWCR_WHPWYB0TT.F_CV_PREP\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCRH.KWCR_WHPWYB0TT.F_CV_PREP\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.803\",\n  \"modified\" : \"2019-12-10T17:02:59.804\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Classic Historian Totalizer Prep Rule\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"KWCRH.KWCR_KIWK050TT.F_CV:sample:PT2M\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Initialize local variable prevValue with the first value in the input array\\nBigDecimal prevValue = __source__.first;\\n//Iterate through each element of the input array\\nforeach(element:__source__.array){\\n    //If the value of the array element is less than 1\\n    if(element.value<1){\\n        //Set the quality of the element to 0\\n        element.quality=0;\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //If the difference between the current value and the previous value\\n    //is greater than 500\\n    if((element.value - prevValue)>500 || (element.value-prevValue<-500)){\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //Set the value of prevValue to the current element value\\n    prevValue = element.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCRH.KWCR_WHPWYB0TT.F_CV\",\n  \"description\" : \"WY1 WY5 Daily Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"@.KWCRH.KWCR_WHPWYB0TT.F_CV_PREP:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"WY1WY5MaxFlow\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCRH.KWCR_WHPWYB0TT.F_CV\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCRH.KWCR_WHPWYB0TT.F_CV\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.805\",\n  \"modified\" : \"2019-12-10T17:02:59.806\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCRH.KWCR_FGSFGB0TT.F_CV_PREP\",\n  \"description\" : \"FG01 FG02 FG04 Classic Historian Totalizer Prep\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_FGSFGB0TT.F_CV:sample:PT2M\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCRH.KWCR_FGSFGB0TT.F_CV_PREP\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCRH.KWCR_FGSFGB0TT.F_CV_PREP\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.807\",\n  \"modified\" : \"2019-12-10T17:02:59.809\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Classic Historian Totalizer Prep Rule\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"KWCRH.KWCR_KIWK050TT.F_CV:sample:PT2M\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Initialize local variable prevValue with the first value in the input array\\nBigDecimal prevValue = __source__.first;\\n//Iterate through each element of the input array\\nforeach(element:__source__.array){\\n    //If the value of the array element is less than 1\\n    if(element.value<1){\\n        //Set the quality of the element to 0\\n        element.quality=0;\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //If the difference between the current value and the previous value\\n    //is greater than 500\\n    if((element.value - prevValue)>500 || (element.value-prevValue<-500)){\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //Set the value of prevValue to the current element value\\n    prevValue = element.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCRH.KWCR_FGSFGB0TT.F_CV\",\n  \"description\" : \"FG01 FG02 FG04 Daily Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"@.KWCRH.KWCR_FGSFGB0TT.F_CV_PREP:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"FG01FG02FG04MaxFlow\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCRH.KWCR_FGSFGB0TT.F_CV\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCRH.KWCR_FGSFGB0TT.F_CV\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.810\",\n  \"modified\" : \"2019-12-10T17:02:59.811\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCRH.KWCR_NDPNDB0TT.F_CV\",\n  \"description\" : \"ND4 ND5 Daily Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"@.KWCRH.KWCR_NDPNDB0TT.F_CV_PREP:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"ND4ND5MaxFlow\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCRH.KWCR_NDPNDB0TT.F_CV\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCRH.KWCR_NDPNDB0TT.F_CV\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.812\",\n  \"modified\" : \"2019-12-10T17:02:59.813\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCRH.KWCR_NDPNDB0TT.F_CV_PREP\",\n  \"description\" : \"ND4 ND5 Classic Historian Totalizer Prep\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_NDPNDB0TT.F_CV:sample:PT2M\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCRH.KWCR_NDPNDB0TT.F_CV_PREP\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCRH.KWCR_NDPNDB0TT.F_CV_PREP\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.814\",\n  \"modified\" : \"2019-12-10T17:02:59.816\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Classic Historian Totalizer Prep Rule\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"KWCRH.KWCR_KIWK050TT.F_CV:sample:PT2M\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Initialize local variable prevValue with the first value in the input array\\nBigDecimal prevValue = __source__.first;\\n//Iterate through each element of the input array\\nforeach(element:__source__.array){\\n    //If the value of the array element is less than 1\\n    if(element.value<1){\\n        //Set the quality of the element to 0\\n        element.quality=0;\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //If the difference between the current value and the previous value\\n    //is greater than 500\\n    if((element.value - prevValue)>500 || (element.value-prevValue<-500)){\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //Set the value of prevValue to the current element value\\n    prevValue = element.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCRH.KWCR_ERROL01TT.F_CV_PREP\",\n  \"description\" : \"Erb Street System Classic Historian Totalizer Prep\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_ERROL01TT.F_CV:sample:PT2M\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCRH.KWCR_ERROL01TT.F_CV_PREP\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCRH.KWCR_ERROL01TT.F_CV_PREP\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.817\",\n  \"modified\" : \"2019-12-10T17:02:59.818\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Classic Historian Totalizer Prep Rule\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"KWCRH.KWCR_KIWK050TT.F_CV:sample:PT2M\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Initialize local variable prevValue with the first value in the input array\\nBigDecimal prevValue = __source__.first;\\n//Iterate through each element of the input array\\nforeach(element:__source__.array){\\n    //If the value of the array element is less than 1\\n    if(element.value<1){\\n        //Set the quality of the element to 0\\n        element.quality=0;\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //If the difference between the current value and the previous value\\n    //is greater than 500\\n    if((element.value - prevValue)>500 || (element.value-prevValue<-500)){\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //Set the value of prevValue to the current element value\\n    prevValue = element.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MTPBLEFIQ01\",\n  \"description\" : \"Grand River surface water supply combined flow rate\",\n  \"engUnits\" : \"L/s\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.WTP_MTPBLE1FIQ01.F_CV:sample:PT2M\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"2db4fc9b-65cf-4e91-841a-a245ed9bc1a4\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ {\n      \"name\" : \"second\",\n      \"pattern\" : \"\",\n      \"query\" : \"KWCRH.WTP_MTPBLE2FIQ01.F_CV:sample:PT2M\",\n      \"type\" : \"tag\"\n    } ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MTPBLEFIQ01\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MTPBLEFIQ01\",\n  \"meta\" : null,\n  \"scale\" : 4,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.819\",\n  \"modified\" : \"2019-12-10T17:02:59.820\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Sum Two Tags\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"2db4fc9b-65cf-4e91-841a-a245ed9bc1a4\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"SJPH.SJPSCDA.CPSC003TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"SJPH.SJPSCDA.CPSC004TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"second\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs) {\\n    //Summing the two tags together\\n    pair.a.value = pair.a.value + pair.b.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2009-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"2db4fc9b-65cf-4e91-841a-a245ed9bc1a4\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2009-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"CBWG004TT\",\n  \"description\" : \"G4 Daily Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.CBWG004TT.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"G4FlowMax\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.CBWG004TT\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"CBWG004TT\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.822\",\n  \"modified\" : \"2021-12-17T14:09:01.141\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"CBWG009TT\",\n  \"description\" : \"G9 Daily Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.G09TWL01FI01QFL.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"G9FlowMax\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.CBWG009TT\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"CBWG009TT\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.824\",\n  \"modified\" : \"2023-07-19T15:02:31.807\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MDPG001_2_3_TTV01\",\n  \"description\" : \"Combined Flow G1, G2, G3\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.G01W0001FI01QFL.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"98034081-9e5c-4fa4-a37c-24b7f64bb4a6\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ {\n      \"name\" : \"third\",\n      \"pattern\" : \"\",\n      \"query\" : \"WATH.MTPSVR2.G03W0003FI01QFL.F_CV:periodTotal:P1D\",\n      \"type\" : \"tag\"\n    }, {\n      \"name\" : \"second\",\n      \"pattern\" : \"\",\n      \"query\" : \"WATH.MTPSVR2.G02W0002FI01QFL.F_CV:periodTotal:P1D\",\n      \"type\" : \"tag\"\n    } ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MDPG001_2_3_TTV01\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MDPG001_2_3_TTV01\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.826\",\n  \"modified\" : \"2022-03-17T21:29:16.035\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Sum Three Tags\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"98034081-9e5c-4fa4-a37c-24b7f64bb4a6\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"SJPH.SJPSCDA.WHPWY01TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"SJPH.SJPSCDA.WHPWY05TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"second\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"SJPH.SJPSCDA.WHPWY06TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"third\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs){\\n    //Summing the two tags together\\n    pair.a.Value = pair.a.Value + pair.b.Value;\\n}\\n//Repeat same procedure using third input tag\\nTagInputPair tipb = new TagInputPair(__source__, third, 60);\\nfor (DataPair pairb: tipb.pairs){\\n    pairb.a.Value = pairb.a.Value + pairb.b.Value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2009-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"98034081-9e5c-4fa4-a37c-24b7f64bb4a6\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2009-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MDPG0014_1A_15TTV01\",\n  \"description\" : \"Combined Flow G14, G1A, G15\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.G14W0014FI01QFL.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"98034081-9e5c-4fa4-a37c-24b7f64bb4a6\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ {\n      \"name\" : \"third\",\n      \"pattern\" : \"\",\n      \"query\" : \"WATH.MTPSVR2.G15W0015FI01QFL.F_CV:periodTotal:P1D\",\n      \"type\" : \"tag\"\n    }, {\n      \"name\" : \"second\",\n      \"pattern\" : \"\",\n      \"query\" : \"WATH.MTPSVR2.G01W001AFI01QFL.F_CV:periodTotal:P1D\",\n      \"type\" : \"tag\"\n    } ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MDPG0014_1A_15TTV01\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MDPG0014_1A_15TTV01\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.829\",\n  \"modified\" : \"2022-03-17T21:29:35.132\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Sum Three Tags\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"98034081-9e5c-4fa4-a37c-24b7f64bb4a6\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"SJPH.SJPSCDA.WHPWY01TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"SJPH.SJPSCDA.WHPWY05TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"second\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"SJPH.SJPSCDA.WHPWY06TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"third\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs){\\n    //Summing the two tags together\\n    pair.a.Value = pair.a.Value + pair.b.Value;\\n}\\n//Repeat same procedure using third input tag\\nTagInputPair tipb = new TagInputPair(__source__, third, 60);\\nfor (DataPair pairb: tipb.pairs){\\n    pairb.a.Value = pairb.a.Value + pairb.b.Value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2009-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"98034081-9e5c-4fa4-a37c-24b7f64bb4a6\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2009-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MDPG00TTVOL1.F_CV\",\n  \"description\" : \"Combined Flow G1, G1A, G2, G3, G14, G15\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.G01W0001FI01QFL.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"e83dc917-740b-40ff-8315-4eea9167dfdc\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ {\n      \"name\" : \"sixth\",\n      \"pattern\" : \"\",\n      \"query\" : \"WATH.MTPSVR2.G15W0015FI01QFL.F_CV:periodTotal:P1D\",\n      \"type\" : \"tag\"\n    }, {\n      \"name\" : \"third\",\n      \"pattern\" : \"\",\n      \"query\" : \"WATH.MTPSVR2.G02W0002FI01QFL.F_CV:periodTotal:P1D\",\n      \"type\" : \"tag\"\n    }, {\n      \"name\" : \"fifth\",\n      \"pattern\" : \"\",\n      \"query\" : \"WATH.MTPSVR2.G14W0014FI01QFL.F_CV:periodTotal:P1D\",\n      \"type\" : \"tag\"\n    }, {\n      \"name\" : \"fourth\",\n      \"pattern\" : \"\",\n      \"query\" : \"WATH.MTPSVR2.G03W0003FI01QFL.F_CV:periodTotal:P1D\",\n      \"type\" : \"tag\"\n    }, {\n      \"name\" : \"second\",\n      \"pattern\" : \"\",\n      \"query\" : \"WATH.MTPSVR2.G01W001AFI01QFL.F_CV:periodTotal:P1D\",\n      \"type\" : \"tag\"\n    } ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MDPG00TTVOL1.F_CV\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MDPG00TTVOL1.F_CV\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.831\",\n  \"modified\" : \"2023-02-22T04:25:49.641\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Sum Six Tags\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"e83dc917-740b-40ff-8315-4eea9167dfdc\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"WATH.MTPSVR2.G01W0001FI01QVA.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : true,\n    \"metadata\" : \"{\\\"descriptors\\\":[],\\\"tag\\\":\\\"WATH.MTPSVR2.G01W0001FI01QVA.F_CV\\\",\\\"mode\\\":\\\"rawByTime\\\",\\\"interval\\\":\\\"P1D\\\"}\"\n  }, {\n    \"value\" : \"WATH.MTPSVR2.G14W0014FI01QVA.F_CV:rawByTime:P1D\",\n    \"name\" : \"fifth\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : \"{\\\"descriptors\\\":[],\\\"tag\\\":\\\"WATH.MTPSVR2.G14W0014FI01QVA.F_CV\\\",\\\"mode\\\":\\\"rawByTime\\\",\\\"interval\\\":\\\"P1D\\\"}\"\n  }, {\n    \"value\" : \"WATH.MTPSVR2.G03W0003FI01QVA.F_CV:rawByTime:P1D\",\n    \"name\" : \"fourth\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : \"{\\\"descriptors\\\":[],\\\"tag\\\":\\\"WATH.MTPSVR2.G03W0003FI01QVA.F_CV\\\",\\\"mode\\\":\\\"rawByTime\\\",\\\"interval\\\":\\\"P1D\\\"}\"\n  }, {\n    \"value\" : \"WATH.MTPSVR2.G01W001AFI01QVA.F_CV:rawByTime:P1D\",\n    \"name\" : \"second\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : \"{\\\"descriptors\\\":[],\\\"tag\\\":\\\"WATH.MTPSVR2.G01W001AFI01QVA.F_CV\\\",\\\"mode\\\":\\\"rawByTime\\\",\\\"interval\\\":\\\"P1D\\\"}\"\n  }, {\n    \"value\" : \"WATH.MTPSVR2.G14W0014FI02QVA.F_CV:rawByTime:P1D\",\n    \"name\" : \"sixth\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : \"{\\\"descriptors\\\":[],\\\"tag\\\":\\\"WATH.MTPSVR2.G14W0014FI02QVA.F_CV\\\",\\\"mode\\\":\\\"rawByTime\\\",\\\"interval\\\":\\\"P1D\\\"}\"\n  }, {\n    \"value\" : \"WATH.MTPSVR2.G02W0002FI01QVA.F_CV:rawByTime:P1D\",\n    \"name\" : \"third\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : \"{\\\"descriptors\\\":[],\\\"tag\\\":\\\"WATH.MTPSVR2.G02W0002FI01QVA.F_CV\\\",\\\"mode\\\":\\\"rawByTime\\\",\\\"interval\\\":\\\"P1D\\\"}\"\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Tag pair of primary and secondary tag\\r\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\r\\n//Loop to run through all of the tag data\\r\\nfor (DataPair pair: tip.pairs){\\r\\n    //Summing the two tags together\\r\\n    pair.a.Value = pair.a.Value + pair.b.Value;\\r\\n}\\r\\n//Repeat same procedure using third input tag\\r\\nTagInputPair tipb = new TagInputPair(__source__, third, 60);\\r\\nfor (DataPair pairb: tipb.pairs){\\r\\n    pairb.a.Value = pairb.a.Value + pairb.b.Value;\\r\\n}\\r\\n//Repeat same procedure using fourth input tag\\r\\nTagInputPair tipb = new TagInputPair(__source__, fourth, 60);\\r\\nfor (DataPair pairb: tipb.pairs){\\r\\n    pairb.a.Value = pairb.a.Value + pairb.b.Value;\\r\\n}\\r\\n//Repeat same procedure using fifth input tag\\r\\nTagInputPair tipb = new TagInputPair(__source__, fifth, 60);\\r\\nfor (DataPair pairb: tipb.pairs){\\r\\n    pairb.a.Value = pairb.a.Value + pairb.b.Value;\\r\\n}\\r\\n//Repeat same procedure using sixth input tag\\r\\nTagInputPair tipb = new TagInputPair(__source__, sixth, 60);\\r\\nfor (DataPair pairb: tipb.pairs){\\r\\n    pairb.a.Value = pairb.a.Value + pairb.b.Value;\\r\\n}\",\n    \"version\" : 1,\n    \"start\" : \"2010-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"e83dc917-740b-40ff-8315-4eea9167dfdc\",\n  \"owner\" : \"aramzie\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2022-06-28T14:46:51.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MDPG00TTVOL1\",\n  \"description\" : \"Middleton G Daily Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"@.MDPG00TTVOL1.F_CV:first:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"MDPFlowMax\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MDPG00TTVOL1\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MDPG00TTVOL1\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.833\",\n  \"modified\" : \"2019-12-10T17:02:59.834\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MDPRES0TTVO1.F_CV\",\n  \"description\" : \"Middleton Reservoir Inlet Daily Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.MDPRES0TTV01.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"MDPFlowMax\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MDPRES0TTVO1.F_CV\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MDPRES0TTVO1.F_CV\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.835\",\n  \"modified\" : \"2021-12-17T04:09:35.289\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MDPCB00TTV01.F_CV\",\n  \"description\" : \"Middleton Discharge Flow Min/Max 10% Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.MDPTWL01FI01QFL.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"TenPercent\",\n      \"constant\" : \"TenPercent\"\n    }, {\n      \"name\" : \"HeidelbergMaxFlow\",\n      \"constant\" : \"MDPFlowMax\"\n    } ],\n    \"inputRef\" : [ {\n      \"name\" : \"second\",\n      \"pattern\" : \"\",\n      \"query\" : \"WATH.MTPSVR2.MDPRES0TTV01.F_CV:periodTotal:P1D\",\n      \"type\" : \"tag\"\n    } ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MDPCB00TTV01.F_CV\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MDPCB00TTV01.F_CV\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.838\",\n  \"modified\" : \"2023-02-22T04:27:21.480\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Min/Max and Relative Difference Flagging\",\n  \"description\" : \"Flags primary input for min and max. Compares primary to secondary tag and applies flag if relative diff. is greater than specified %.\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\",\n  \"constant\" : [ \"HeidelbergMaxFlow\", \"HeidelbergMinFlow\", \"TenPercent\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"SJPH.SJPSCDA.HEPTWL1TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"@.HEPWELLTT.F_CV:first:P1D\",\n    \"name\" : \"second\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Primary loop for source tag\\nfor (Data PD: __source__.array){\\n    //Check if above maximum\\n    if(PD.value > $(HeidelbergMaxFlow)) {\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n    //Check if below minimum\\n    if (PD.value < $(HeidelbergMinFlow)) {\\n        PD.addFlag(\\\"MIN\\\");\\n    }\\n}\\n//Initialize variables to hold relative difference calculations\\nBigDecimal relDiff = 0;\\nBigDecimal relDiff2 = 0;\\n//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs){\\n    //Calculate difference relative to first value\\n    if(pair.a.value!=0){\\n        relDiff = ((pair.a.value-pair.b.value)/pair.a.value);\\n    }\\n    if(pair.b.value!=0){\\n        //Calculate difference relative to second value\\n        relDiff2 = ((pair.a.value-pair.b.value)/pair.b.value);\\n    }\\n    //Flag value if relative difference is greater than 10%\\n    if(relDiff > 0.10||relDiff < -0.10||relDiff2 > 0.10||relDiff2 < -0.10)\\n        pair.a.addFlag(\\\"OUT\\\");\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  }, {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal heidelbergMaxFlow = HeidelbergMaxFlow.getValue(PD);\\n    context.trace(HeidelbergMaxFlow.getValue(PD));\\n    if(PD.value > heidelbergMaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n    //If the value of the element is below threshold\\n    BigDecimal heidelbergMinFlow = HeidelbergMinFlow.getValue(PD);\\n    if (PD.value < heidelbergMinFlow) {\\n        //Apply \\\"MIN\\\" flag to data element\\n        PD.addFlag(\\\"MIN\\\");\\n    }\\n}\\n//Initialize variables to hold relative difference calculations\\nBigDecimal relDiff = 0;\\n//BigDecimal relDiff2 = 0;\\n//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs){\\n    //Calculate difference relative to first value\\n    if(pair.a.value!=0){\\n        relDiff = ((pair.a.value-pair.b.value)/pair.a.value);\\n        context.trace(relDiff);\\n        BigDecimal tenPercent = TenPercent.getValue(pair);\\n        if(Math.abs(relDiff) > tenPercent){\\n            pair.a.addFlag(\\\"OUT\\\");\\n        }\\n    }\\n}\\n\",\n    \"version\" : 2,\n    \"start\" : \"2015-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : false\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\",\n  \"owner\" : \"ralbasel@regionofwaterloo.ca\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCR_BLMVCH1TTV01.F_CV_PREP\",\n  \"description\" : \"Breslau Meter Classic Historian Totalizer Prep\",\n  \"engUnits\" : \"M3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_BLMVCH1TTV01.F_CV:sample:PT2M\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCR_BLMVCH1TTV01.F_CV_PREP\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCR_BLMVCH1TTV01.F_CV_PREP\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.840\",\n  \"modified\" : \"2019-12-10T17:02:59.841\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Classic Historian Totalizer Prep Rule\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"KWCRH.KWCR_KIWK050TT.F_CV:sample:PT2M\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Initialize local variable prevValue with the first value in the input array\\nBigDecimal prevValue = __source__.first;\\n//Iterate through each element of the input array\\nforeach(element:__source__.array){\\n    //If the value of the array element is less than 1\\n    if(element.value<1){\\n        //Set the quality of the element to 0\\n        element.quality=0;\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //If the difference between the current value and the previous value\\n    //is greater than 500\\n    if((element.value - prevValue)>500 || (element.value-prevValue<-500)){\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //Set the value of prevValue to the current element value\\n    prevValue = element.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"ATPWELLTT\",\n  \"description\" : \"Ayr Combined Well Flow\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.ATPW0001FI01QFL.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"98034081-9e5c-4fa4-a37c-24b7f64bb4a6\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ {\n      \"name\" : \"third\",\n      \"pattern\" : \"\",\n      \"query\" : \"WATH.MTPSVR2.APSW0003FI01QFL.F_CV:periodTotal:P1D\",\n      \"type\" : \"tag\"\n    }, {\n      \"name\" : \"second\",\n      \"pattern\" : \"\",\n      \"query\" : \"WATH.MTPSVR2.ATPW0002FI01QFL.F_CV:periodTotal:P1D\",\n      \"type\" : \"tag\"\n    } ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.ATPWELLTT\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"ATPWELLTT\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.849\",\n  \"modified\" : \"2023-05-29T15:18:50.765\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Sum Three Tags\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"98034081-9e5c-4fa4-a37c-24b7f64bb4a6\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"SJPH.SJPSCDA.WHPWY01TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"SJPH.SJPSCDA.WHPWY05TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"second\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"SJPH.SJPSCDA.WHPWY06TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"third\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs){\\n    //Summing the two tags together\\n    pair.a.Value = pair.a.Value + pair.b.Value;\\n}\\n//Repeat same procedure using third input tag\\nTagInputPair tipb = new TagInputPair(__source__, third, 60);\\nfor (DataPair pairb: tipb.pairs){\\n    pairb.a.Value = pairb.a.Value + pairb.b.Value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2009-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"98034081-9e5c-4fa4-a37c-24b7f64bb4a6\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2009-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"ATPA000TT\",\n  \"description\" : \"Ayr Combined Well Flow with Min/Max Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"@.ATPWELLTT:first:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"1792427b-310b-4745-bf9d-bfda3efedd35\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"AyrMaxFlowOp\"\n    }, {\n      \"name\" : \"MV3MinFlow\",\n      \"constant\" : \"AyrMinFlowOp\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.ATPA000TT\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"ATPA000TT\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.851\",\n  \"modified\" : \"2019-12-10T17:02:59.852\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging\",\n  \"description\" : \"Flow Total Flagging Rule (Maximum and Minimum)\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"1792427b-310b-4745-bf9d-bfda3efedd35\",\n  \"constant\" : [ \"MV3MaxFlow\", \"MV3MinFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.HRMMV03TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P2D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    if(PD.value > $(MV3MaxFlow)) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n    //If the value of the element is below threshold\\n    if (PD.value < $(MV3MinFlow)) {\\n        //Apply \\\"MIN\\\" flag to data element\\n        PD.addFlag(\\\"MIN\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"1792427b-310b-4745-bf9d-bfda3efedd35\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"ATPTWL1VOLFLAG\",\n  \"description\" : \"Ayr Discharge with min/max and relative difference flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.APSTWL01FI01QFL.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"TenPercent\",\n      \"constant\" : \"TwentyPercent\"\n    }, {\n      \"name\" : \"HeidelbergMinFlow\",\n      \"constant\" : \"AyrMinFlowOp\"\n    }, {\n      \"name\" : \"HeidelbergMaxFlow\",\n      \"constant\" : \"AyrMaxFlowOp\"\n    } ],\n    \"inputRef\" : [ {\n      \"name\" : \"second\",\n      \"pattern\" : \"\",\n      \"query\" : \"@.ATPWELLTT:first:P1D\",\n      \"type\" : \"tag\"\n    } ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.ATPTWL1VOLFLAG\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"ATPTWL1VOLFLAG\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.853\",\n  \"modified\" : \"2023-05-05T02:40:40.527\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Min/Max and Relative Difference Flagging\",\n  \"description\" : \"Flags primary input for min and max. Compares primary to secondary tag and applies flag if relative diff. is greater than specified %.\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\",\n  \"constant\" : [ \"HeidelbergMaxFlow\", \"HeidelbergMinFlow\", \"TenPercent\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"SJPH.SJPSCDA.HEPTWL1TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"@.HEPWELLTT.F_CV:first:P1D\",\n    \"name\" : \"second\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Primary loop for source tag\\nfor (Data PD: __source__.array){\\n    //Check if above maximum\\n    if(PD.value > $(HeidelbergMaxFlow)) {\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n    //Check if below minimum\\n    if (PD.value < $(HeidelbergMinFlow)) {\\n        PD.addFlag(\\\"MIN\\\");\\n    }\\n}\\n//Initialize variables to hold relative difference calculations\\nBigDecimal relDiff = 0;\\nBigDecimal relDiff2 = 0;\\n//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs){\\n    //Calculate difference relative to first value\\n    if(pair.a.value!=0){\\n        relDiff = ((pair.a.value-pair.b.value)/pair.a.value);\\n    }\\n    if(pair.b.value!=0){\\n        //Calculate difference relative to second value\\n        relDiff2 = ((pair.a.value-pair.b.value)/pair.b.value);\\n    }\\n    //Flag value if relative difference is greater than 10%\\n    if(relDiff > 0.10||relDiff < -0.10||relDiff2 > 0.10||relDiff2 < -0.10)\\n        pair.a.addFlag(\\\"OUT\\\");\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  }, {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal heidelbergMaxFlow = HeidelbergMaxFlow.getValue(PD);\\n    context.trace(HeidelbergMaxFlow.getValue(PD));\\n    if(PD.value > heidelbergMaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n    //If the value of the element is below threshold\\n    BigDecimal heidelbergMinFlow = HeidelbergMinFlow.getValue(PD);\\n    if (PD.value < heidelbergMinFlow) {\\n        //Apply \\\"MIN\\\" flag to data element\\n        PD.addFlag(\\\"MIN\\\");\\n    }\\n}\\n//Initialize variables to hold relative difference calculations\\nBigDecimal relDiff = 0;\\n//BigDecimal relDiff2 = 0;\\n//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs){\\n    //Calculate difference relative to first value\\n    if(pair.a.value!=0){\\n        relDiff = ((pair.a.value-pair.b.value)/pair.a.value);\\n        context.trace(relDiff);\\n        BigDecimal tenPercent = TenPercent.getValue(pair);\\n        if(Math.abs(relDiff) > tenPercent){\\n            pair.a.addFlag(\\\"OUT\\\");\\n        }\\n    }\\n}\\n\",\n    \"version\" : 2,\n    \"start\" : \"2015-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : false\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\",\n  \"owner\" : \"ralbasel@regionofwaterloo.ca\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCR_RTPR006TT.F_CV_PREP\",\n  \"description\" : \"Roseville 6 Classic Historian Totalizer Prep\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_RTPR006TT.F_CV:sample:PT2M\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCR_RTPR006TT.F_CV_PREP\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCR_RTPR006TT.F_CV_PREP\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.856\",\n  \"modified\" : \"2019-12-10T17:02:59.857\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Classic Historian Totalizer Prep Rule\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"KWCRH.KWCR_KIWK050TT.F_CV:sample:PT2M\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Initialize local variable prevValue with the first value in the input array\\nBigDecimal prevValue = __source__.first;\\n//Iterate through each element of the input array\\nforeach(element:__source__.array){\\n    //If the value of the array element is less than 1\\n    if(element.value<1){\\n        //Set the quality of the element to 0\\n        element.quality=0;\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //If the difference between the current value and the previous value\\n    //is greater than 500\\n    if((element.value - prevValue)>500 || (element.value-prevValue<-500)){\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //Set the value of prevValue to the current element value\\n    prevValue = element.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCR_RTPR005TT.F_CV_PREP\",\n  \"description\" : \"Roseville 5 Classic Historian Totalizer Prep\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_RTPR005TT.F_CV:sample:PT2M\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCR_RTPR005TT.F_CV_PREP\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCR_RTPR005TT.F_CV_PREP\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.858\",\n  \"modified\" : \"2019-12-10T17:02:59.859\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Classic Historian Totalizer Prep Rule\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"KWCRH.KWCR_KIWK050TT.F_CV:sample:PT2M\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Initialize local variable prevValue with the first value in the input array\\nBigDecimal prevValue = __source__.first;\\n//Iterate through each element of the input array\\nforeach(element:__source__.array){\\n    //If the value of the array element is less than 1\\n    if(element.value<1){\\n        //Set the quality of the element to 0\\n        element.quality=0;\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //If the difference between the current value and the previous value\\n    //is greater than 500\\n    if((element.value - prevValue)>500 || (element.value-prevValue<-500)){\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //Set the value of prevValue to the current element value\\n    prevValue = element.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"RTPWELLTT\",\n  \"description\" : \"Roseville Combined Daily Well Flow\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_RTPR005TT.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"2db4fc9b-65cf-4e91-841a-a245ed9bc1a4\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ {\n      \"name\" : \"second\",\n      \"pattern\" : \"\",\n      \"query\" : \"KWCRH.KWCR_RTPR006TT.F_CV:periodTotal:P1D\",\n      \"type\" : \"tag\"\n    } ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.RTPWELLTT\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"RTPWELLTT\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.860\",\n  \"modified\" : \"2019-12-10T17:02:59.862\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Sum Two Tags\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"2db4fc9b-65cf-4e91-841a-a245ed9bc1a4\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"SJPH.SJPSCDA.CPSC003TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"SJPH.SJPSCDA.CPSC004TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"second\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs) {\\n    //Summing the two tags together\\n    pair.a.value = pair.a.value + pair.b.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2009-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"2db4fc9b-65cf-4e91-841a-a245ed9bc1a4\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2009-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"RTPR000TT\",\n  \"description\" : \"Roseville Combined Daily Well Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"@.RTPWELLTT:first:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"RosevilleMaxFlowOp\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.RTPR000TT\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"RTPR000TT\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.863\",\n  \"modified\" : \"2019-12-10T17:02:59.864\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"RTPTWL1VOLFLAG\",\n  \"description\" : \"Roseville Discharge Flow With Min/Max and Relative Difference Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_RTPTWL1TT.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"HeidelbergMinFlow\",\n      \"constant\" : \"HeidelbergMinFlow\"\n    }, {\n      \"name\" : \"HeidelbergMaxFlow\",\n      \"constant\" : \"RosevilleMaxFlowOp\"\n    }, {\n      \"name\" : \"TenPercent\",\n      \"constant\" : \"TwentyPercent\"\n    } ],\n    \"inputRef\" : [ {\n      \"name\" : \"second\",\n      \"pattern\" : \"\",\n      \"query\" : \"@.RTPR000TT:first:P1D\",\n      \"type\" : \"tag\"\n    } ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.RTPTWL1VOLFLAG\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"RTPTWL1VOLFLAG\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.865\",\n  \"modified\" : \"2019-12-10T17:02:59.866\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Min/Max and Relative Difference Flagging\",\n  \"description\" : \"Flags primary input for min and max. Compares primary to secondary tag and applies flag if relative diff. is greater than specified %.\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\",\n  \"constant\" : [ \"HeidelbergMaxFlow\", \"HeidelbergMinFlow\", \"TenPercent\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"SJPH.SJPSCDA.HEPTWL1TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"@.HEPWELLTT.F_CV:first:P1D\",\n    \"name\" : \"second\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Primary loop for source tag\\nfor (Data PD: __source__.array){\\n    //Check if above maximum\\n    if(PD.value > $(HeidelbergMaxFlow)) {\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n    //Check if below minimum\\n    if (PD.value < $(HeidelbergMinFlow)) {\\n        PD.addFlag(\\\"MIN\\\");\\n    }\\n}\\n//Initialize variables to hold relative difference calculations\\nBigDecimal relDiff = 0;\\nBigDecimal relDiff2 = 0;\\n//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs){\\n    //Calculate difference relative to first value\\n    if(pair.a.value!=0){\\n        relDiff = ((pair.a.value-pair.b.value)/pair.a.value);\\n    }\\n    if(pair.b.value!=0){\\n        //Calculate difference relative to second value\\n        relDiff2 = ((pair.a.value-pair.b.value)/pair.b.value);\\n    }\\n    //Flag value if relative difference is greater than 10%\\n    if(relDiff > 0.10||relDiff < -0.10||relDiff2 > 0.10||relDiff2 < -0.10)\\n        pair.a.addFlag(\\\"OUT\\\");\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  }, {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal heidelbergMaxFlow = HeidelbergMaxFlow.getValue(PD);\\n    context.trace(HeidelbergMaxFlow.getValue(PD));\\n    if(PD.value > heidelbergMaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n    //If the value of the element is below threshold\\n    BigDecimal heidelbergMinFlow = HeidelbergMinFlow.getValue(PD);\\n    if (PD.value < heidelbergMinFlow) {\\n        //Apply \\\"MIN\\\" flag to data element\\n        PD.addFlag(\\\"MIN\\\");\\n    }\\n}\\n//Initialize variables to hold relative difference calculations\\nBigDecimal relDiff = 0;\\n//BigDecimal relDiff2 = 0;\\n//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs){\\n    //Calculate difference relative to first value\\n    if(pair.a.value!=0){\\n        relDiff = ((pair.a.value-pair.b.value)/pair.a.value);\\n        context.trace(relDiff);\\n        BigDecimal tenPercent = TenPercent.getValue(pair);\\n        if(Math.abs(relDiff) > tenPercent){\\n            pair.a.addFlag(\\\"OUT\\\");\\n        }\\n    }\\n}\\n\",\n    \"version\" : 2,\n    \"start\" : \"2015-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : false\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\",\n  \"owner\" : \"ralbasel@regionofwaterloo.ca\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCR_BMSBM01TT.F_CV_PREP\",\n  \"description\" : \"Branchton 1 Classic Historian Totalizer Prep\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_BMSBM01TT.F_CV:sample:PT2M\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCR_BMSBM01TT.F_CV_PREP\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCR_BMSBM01TT.F_CV_PREP\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.867\",\n  \"modified\" : \"2019-12-10T17:02:59.868\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Classic Historian Totalizer Prep Rule\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"KWCRH.KWCR_KIWK050TT.F_CV:sample:PT2M\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Initialize local variable prevValue with the first value in the input array\\nBigDecimal prevValue = __source__.first;\\n//Iterate through each element of the input array\\nforeach(element:__source__.array){\\n    //If the value of the array element is less than 1\\n    if(element.value<1){\\n        //Set the quality of the element to 0\\n        element.quality=0;\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //If the difference between the current value and the previous value\\n    //is greater than 500\\n    if((element.value - prevValue)>500 || (element.value-prevValue<-500)){\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //Set the value of prevValue to the current element value\\n    prevValue = element.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCR_BMSBM02TT.F_CV_PREP\",\n  \"description\" : \"Branchton 2 Classic Historian Totalizer Prep\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_BMSBM02TT.F_CV:sample:PT2M\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCR_BMSBM02TT.F_CV_PREP\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCR_BMSBM02TT.F_CV_PREP\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.870\",\n  \"modified\" : \"2019-12-10T17:02:59.871\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Classic Historian Totalizer Prep Rule\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"KWCRH.KWCR_KIWK050TT.F_CV:sample:PT2M\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Initialize local variable prevValue with the first value in the input array\\nBigDecimal prevValue = __source__.first;\\n//Iterate through each element of the input array\\nforeach(element:__source__.array){\\n    //If the value of the array element is less than 1\\n    if(element.value<1){\\n        //Set the quality of the element to 0\\n        element.quality=0;\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //If the difference between the current value and the previous value\\n    //is greater than 500\\n    if((element.value - prevValue)>500 || (element.value-prevValue<-500)){\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //Set the value of prevValue to the current element value\\n    prevValue = element.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"BMSWELLTT\",\n  \"description\" : \"Branchton Combined Well Flow\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_BMSBM01TT.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"2db4fc9b-65cf-4e91-841a-a245ed9bc1a4\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ {\n      \"name\" : \"second\",\n      \"pattern\" : \"\",\n      \"query\" : \"KWCRH.KWCR_BMSBM02TT.F_CV:periodTotal:P1D\",\n      \"type\" : \"tag\"\n    } ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.BMSWELLTT\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"BMSWELLTT\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.873\",\n  \"modified\" : \"2019-12-10T17:02:59.874\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Sum Two Tags\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"2db4fc9b-65cf-4e91-841a-a245ed9bc1a4\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"SJPH.SJPSCDA.CPSC003TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"SJPH.SJPSCDA.CPSC004TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"second\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs) {\\n    //Summing the two tags together\\n    pair.a.value = pair.a.value + pair.b.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2009-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"2db4fc9b-65cf-4e91-841a-a245ed9bc1a4\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2009-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"BMSBM00TT\",\n  \"description\" : \"Branchton Combined Well Flow With Max Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"@.BMSWELLTT.F_CV:first:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"BranchtonMaxFlowOp\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.BMSBM00TT\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"BMSBM00TT\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.875\",\n  \"modified\" : \"2020-12-14T17:18:28.378\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"BMSTWL1VOLFLAG\",\n  \"description\" : \"Branchton Discharge Flow With Min/Max And Relative Difference Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_BMSTWL1TT.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"HeidelbergMaxFlow\",\n      \"constant\" : \"BranchtonMaxFlowOp\"\n    }, {\n      \"name\" : \"TenPercent\",\n      \"constant\" : \"TwentyPercent\"\n    } ],\n    \"inputRef\" : [ {\n      \"name\" : \"second\",\n      \"pattern\" : \"\",\n      \"query\" : \"@.BMSBM00TT:first:P1D\",\n      \"type\" : \"tag\"\n    } ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.BMSTWL1VOLFLAG\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"BMSTWL1VOLFLAG\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.877\",\n  \"modified\" : \"2019-12-10T17:02:59.878\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Min/Max and Relative Difference Flagging\",\n  \"description\" : \"Flags primary input for min and max. Compares primary to secondary tag and applies flag if relative diff. is greater than specified %.\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\",\n  \"constant\" : [ \"HeidelbergMaxFlow\", \"HeidelbergMinFlow\", \"TenPercent\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"SJPH.SJPSCDA.HEPTWL1TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"@.HEPWELLTT.F_CV:first:P1D\",\n    \"name\" : \"second\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Primary loop for source tag\\nfor (Data PD: __source__.array){\\n    //Check if above maximum\\n    if(PD.value > $(HeidelbergMaxFlow)) {\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n    //Check if below minimum\\n    if (PD.value < $(HeidelbergMinFlow)) {\\n        PD.addFlag(\\\"MIN\\\");\\n    }\\n}\\n//Initialize variables to hold relative difference calculations\\nBigDecimal relDiff = 0;\\nBigDecimal relDiff2 = 0;\\n//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs){\\n    //Calculate difference relative to first value\\n    if(pair.a.value!=0){\\n        relDiff = ((pair.a.value-pair.b.value)/pair.a.value);\\n    }\\n    if(pair.b.value!=0){\\n        //Calculate difference relative to second value\\n        relDiff2 = ((pair.a.value-pair.b.value)/pair.b.value);\\n    }\\n    //Flag value if relative difference is greater than 10%\\n    if(relDiff > 0.10||relDiff < -0.10||relDiff2 > 0.10||relDiff2 < -0.10)\\n        pair.a.addFlag(\\\"OUT\\\");\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  }, {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal heidelbergMaxFlow = HeidelbergMaxFlow.getValue(PD);\\n    context.trace(HeidelbergMaxFlow.getValue(PD));\\n    if(PD.value > heidelbergMaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n    //If the value of the element is below threshold\\n    BigDecimal heidelbergMinFlow = HeidelbergMinFlow.getValue(PD);\\n    if (PD.value < heidelbergMinFlow) {\\n        //Apply \\\"MIN\\\" flag to data element\\n        PD.addFlag(\\\"MIN\\\");\\n    }\\n}\\n//Initialize variables to hold relative difference calculations\\nBigDecimal relDiff = 0;\\n//BigDecimal relDiff2 = 0;\\n//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs){\\n    //Calculate difference relative to first value\\n    if(pair.a.value!=0){\\n        relDiff = ((pair.a.value-pair.b.value)/pair.a.value);\\n        context.trace(relDiff);\\n        BigDecimal tenPercent = TenPercent.getValue(pair);\\n        if(Math.abs(relDiff) > tenPercent){\\n            pair.a.addFlag(\\\"OUT\\\");\\n        }\\n    }\\n}\\n\",\n    \"version\" : 2,\n    \"start\" : \"2015-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : false\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\",\n  \"owner\" : \"ralbasel@regionofwaterloo.ca\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"WMHWM00TT\",\n  \"description\" : \"West Montrose Well Flow With Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.WMHIL001FI01QFL.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.WMHWM00TT\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"WMHWM00TT\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.879\",\n  \"modified\" : \"2022-12-15T20:01:36.058\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"WMHTWL1VOLFLAG\",\n  \"description\" : \"West Montrose Discharge Min/Max and Relative Difference Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.WMHTWL01FI01QFL.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"TenPercent\",\n      \"constant\" : \"TwentyPercent\"\n    }, {\n      \"name\" : \"HeidelbergMinFlow\",\n      \"constant\" : \"HeidelbergMinFlow\"\n    }, {\n      \"name\" : \"HeidelbergMaxFlow\",\n      \"constant\" : \"WMontroseMaxFlowOp\"\n    } ],\n    \"inputRef\" : [ {\n      \"name\" : \"second\",\n      \"pattern\" : \"\",\n      \"query\" : \"@.WMHWM00TT:first:P1D\",\n      \"type\" : \"tag\"\n    } ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.WMHTWL1VOLFLAG\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"WMHTWL1VOLFLAG\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.881\",\n  \"modified\" : \"2022-12-15T20:01:53.420\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Min/Max and Relative Difference Flagging\",\n  \"description\" : \"Flags primary input for min and max. Compares primary to secondary tag and applies flag if relative diff. is greater than specified %.\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\",\n  \"constant\" : [ \"HeidelbergMaxFlow\", \"HeidelbergMinFlow\", \"TenPercent\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"SJPH.SJPSCDA.HEPTWL1TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"@.HEPWELLTT.F_CV:first:P1D\",\n    \"name\" : \"second\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Primary loop for source tag\\nfor (Data PD: __source__.array){\\n    //Check if above maximum\\n    if(PD.value > $(HeidelbergMaxFlow)) {\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n    //Check if below minimum\\n    if (PD.value < $(HeidelbergMinFlow)) {\\n        PD.addFlag(\\\"MIN\\\");\\n    }\\n}\\n//Initialize variables to hold relative difference calculations\\nBigDecimal relDiff = 0;\\nBigDecimal relDiff2 = 0;\\n//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs){\\n    //Calculate difference relative to first value\\n    if(pair.a.value!=0){\\n        relDiff = ((pair.a.value-pair.b.value)/pair.a.value);\\n    }\\n    if(pair.b.value!=0){\\n        //Calculate difference relative to second value\\n        relDiff2 = ((pair.a.value-pair.b.value)/pair.b.value);\\n    }\\n    //Flag value if relative difference is greater than 10%\\n    if(relDiff > 0.10||relDiff < -0.10||relDiff2 > 0.10||relDiff2 < -0.10)\\n        pair.a.addFlag(\\\"OUT\\\");\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  }, {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal heidelbergMaxFlow = HeidelbergMaxFlow.getValue(PD);\\n    context.trace(HeidelbergMaxFlow.getValue(PD));\\n    if(PD.value > heidelbergMaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n    //If the value of the element is below threshold\\n    BigDecimal heidelbergMinFlow = HeidelbergMinFlow.getValue(PD);\\n    if (PD.value < heidelbergMinFlow) {\\n        //Apply \\\"MIN\\\" flag to data element\\n        PD.addFlag(\\\"MIN\\\");\\n    }\\n}\\n//Initialize variables to hold relative difference calculations\\nBigDecimal relDiff = 0;\\n//BigDecimal relDiff2 = 0;\\n//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs){\\n    //Calculate difference relative to first value\\n    if(pair.a.value!=0){\\n        relDiff = ((pair.a.value-pair.b.value)/pair.a.value);\\n        context.trace(relDiff);\\n        BigDecimal tenPercent = TenPercent.getValue(pair);\\n        if(Math.abs(relDiff) > tenPercent){\\n            pair.a.addFlag(\\\"OUT\\\");\\n        }\\n    }\\n}\\n\",\n    \"version\" : 2,\n    \"start\" : \"2015-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : false\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\",\n  \"owner\" : \"ralbasel@regionofwaterloo.ca\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"CBWG005TT\",\n  \"description\" : \"G5 Well Flow Total With Max Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.G05TWL01FI01QFL.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"G5MaxFlow\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.CBWG005TT\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"CBWG005TT\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.885\",\n  \"modified\" : \"2021-10-14T15:28:24.656\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"WHPWYB0TTVOLFLAG\",\n  \"description\" : \"Wellesley Station Discharge Flow With Min/Max and Relative Difference Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.WHPTWL01FI01QFL.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"TenPercent\",\n      \"constant\" : \"TwentyPercent\"\n    }, {\n      \"name\" : \"HeidelbergMinFlow\",\n      \"constant\" : \"WellesleyMinFlow\"\n    }, {\n      \"name\" : \"HeidelbergMaxFlow\",\n      \"constant\" : \"WellesleyMaxFlow\"\n    } ],\n    \"inputRef\" : [ {\n      \"name\" : \"second\",\n      \"pattern\" : \"\",\n      \"query\" : \"@.WHPWY00TT.F_CV:first:P1D\",\n      \"type\" : \"tag\"\n    } ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.WHPWYB0TTVOLFLAG\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"WHPWYB0TTVOLFLAG\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.887\",\n  \"modified\" : \"2021-05-27T16:42:39.475\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Min/Max and Relative Difference Flagging\",\n  \"description\" : \"Flags primary input for min and max. Compares primary to secondary tag and applies flag if relative diff. is greater than specified %.\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\",\n  \"constant\" : [ \"HeidelbergMaxFlow\", \"HeidelbergMinFlow\", \"TenPercent\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"SJPH.SJPSCDA.HEPTWL1TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"@.HEPWELLTT.F_CV:first:P1D\",\n    \"name\" : \"second\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Primary loop for source tag\\nfor (Data PD: __source__.array){\\n    //Check if above maximum\\n    if(PD.value > $(HeidelbergMaxFlow)) {\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n    //Check if below minimum\\n    if (PD.value < $(HeidelbergMinFlow)) {\\n        PD.addFlag(\\\"MIN\\\");\\n    }\\n}\\n//Initialize variables to hold relative difference calculations\\nBigDecimal relDiff = 0;\\nBigDecimal relDiff2 = 0;\\n//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs){\\n    //Calculate difference relative to first value\\n    if(pair.a.value!=0){\\n        relDiff = ((pair.a.value-pair.b.value)/pair.a.value);\\n    }\\n    if(pair.b.value!=0){\\n        //Calculate difference relative to second value\\n        relDiff2 = ((pair.a.value-pair.b.value)/pair.b.value);\\n    }\\n    //Flag value if relative difference is greater than 10%\\n    if(relDiff > 0.10||relDiff < -0.10||relDiff2 > 0.10||relDiff2 < -0.10)\\n        pair.a.addFlag(\\\"OUT\\\");\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  }, {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal heidelbergMaxFlow = HeidelbergMaxFlow.getValue(PD);\\n    context.trace(HeidelbergMaxFlow.getValue(PD));\\n    if(PD.value > heidelbergMaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n    //If the value of the element is below threshold\\n    BigDecimal heidelbergMinFlow = HeidelbergMinFlow.getValue(PD);\\n    if (PD.value < heidelbergMinFlow) {\\n        //Apply \\\"MIN\\\" flag to data element\\n        PD.addFlag(\\\"MIN\\\");\\n    }\\n}\\n//Initialize variables to hold relative difference calculations\\nBigDecimal relDiff = 0;\\n//BigDecimal relDiff2 = 0;\\n//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs){\\n    //Calculate difference relative to first value\\n    if(pair.a.value!=0){\\n        relDiff = ((pair.a.value-pair.b.value)/pair.a.value);\\n        context.trace(relDiff);\\n        BigDecimal tenPercent = TenPercent.getValue(pair);\\n        if(Math.abs(relDiff) > tenPercent){\\n            pair.a.addFlag(\\\"OUT\\\");\\n        }\\n    }\\n}\\n\",\n    \"version\" : 2,\n    \"start\" : \"2015-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : false\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\",\n  \"owner\" : \"ralbasel@regionofwaterloo.ca\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCR_VIMVCH1TT.F_CV_PREP\",\n  \"description\" : \"Victoria Meter Classic Historian Totalizer Prep\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_VIMVCH1TT.F_CV:sample:PT2M\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCR_VIMVCH1TT.F_CV_PREP\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCR_VIMVCH1TT.F_CV_PREP\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.889\",\n  \"modified\" : \"2019-12-10T17:02:59.890\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Classic Historian Totalizer Prep Rule\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"KWCRH.KWCR_KIWK050TT.F_CV:sample:PT2M\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Initialize local variable prevValue with the first value in the input array\\nBigDecimal prevValue = __source__.first;\\n//Iterate through each element of the input array\\nforeach(element:__source__.array){\\n    //If the value of the array element is less than 1\\n    if(element.value<1){\\n        //Set the quality of the element to 0\\n        element.quality=0;\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //If the difference between the current value and the previous value\\n    //is greater than 500\\n    if((element.value - prevValue)>500 || (element.value-prevValue<-500)){\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //Set the value of prevValue to the current element value\\n    prevValue = element.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"NDPNDB0TTVOLFLAG\",\n  \"description\" : \"New Dundee Discharge With Min/Max And Relative Difference Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR3.NDPTWL01FI01QFL.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"TenPercent\",\n      \"constant\" : \"TwentyPercent\"\n    }, {\n      \"name\" : \"HeidelbergMinFlow\",\n      \"constant\" : \"NewDundeeMinFlow\"\n    }, {\n      \"name\" : \"HeidelbergMaxFlow\",\n      \"constant\" : \"NewDundeeMaxFlow\"\n    } ],\n    \"inputRef\" : [ {\n      \"name\" : \"second\",\n      \"pattern\" : \"\",\n      \"query\" : \"@.NDPWELLTT.F_CV:first:P1D\",\n      \"type\" : \"tag\"\n    } ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.NDPNDB0TTVOLFLAG\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"NDPNDB0TTVOLFLAG\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.892\",\n  \"modified\" : \"2023-06-10T16:17:00.134\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Min/Max and Relative Difference Flagging\",\n  \"description\" : \"Flags primary input for min and max. Compares primary to secondary tag and applies flag if relative diff. is greater than specified %.\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\",\n  \"constant\" : [ \"HeidelbergMaxFlow\", \"HeidelbergMinFlow\", \"TenPercent\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"SJPH.SJPSCDA.HEPTWL1TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"@.HEPWELLTT.F_CV:first:P1D\",\n    \"name\" : \"second\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Primary loop for source tag\\nfor (Data PD: __source__.array){\\n    //Check if above maximum\\n    if(PD.value > $(HeidelbergMaxFlow)) {\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n    //Check if below minimum\\n    if (PD.value < $(HeidelbergMinFlow)) {\\n        PD.addFlag(\\\"MIN\\\");\\n    }\\n}\\n//Initialize variables to hold relative difference calculations\\nBigDecimal relDiff = 0;\\nBigDecimal relDiff2 = 0;\\n//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs){\\n    //Calculate difference relative to first value\\n    if(pair.a.value!=0){\\n        relDiff = ((pair.a.value-pair.b.value)/pair.a.value);\\n    }\\n    if(pair.b.value!=0){\\n        //Calculate difference relative to second value\\n        relDiff2 = ((pair.a.value-pair.b.value)/pair.b.value);\\n    }\\n    //Flag value if relative difference is greater than 10%\\n    if(relDiff > 0.10||relDiff < -0.10||relDiff2 > 0.10||relDiff2 < -0.10)\\n        pair.a.addFlag(\\\"OUT\\\");\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  }, {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal heidelbergMaxFlow = HeidelbergMaxFlow.getValue(PD);\\n    context.trace(HeidelbergMaxFlow.getValue(PD));\\n    if(PD.value > heidelbergMaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n    //If the value of the element is below threshold\\n    BigDecimal heidelbergMinFlow = HeidelbergMinFlow.getValue(PD);\\n    if (PD.value < heidelbergMinFlow) {\\n        //Apply \\\"MIN\\\" flag to data element\\n        PD.addFlag(\\\"MIN\\\");\\n    }\\n}\\n//Initialize variables to hold relative difference calculations\\nBigDecimal relDiff = 0;\\n//BigDecimal relDiff2 = 0;\\n//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs){\\n    //Calculate difference relative to first value\\n    if(pair.a.value!=0){\\n        relDiff = ((pair.a.value-pair.b.value)/pair.a.value);\\n        context.trace(relDiff);\\n        BigDecimal tenPercent = TenPercent.getValue(pair);\\n        if(Math.abs(relDiff) > tenPercent){\\n            pair.a.addFlag(\\\"OUT\\\");\\n        }\\n    }\\n}\\n\",\n    \"version\" : 2,\n    \"start\" : \"2015-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : false\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\",\n  \"owner\" : \"ralbasel@regionofwaterloo.ca\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"CBWH004TT\",\n  \"description\" : \"H4 Daily Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.H04TWL01FI01QFL.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"H4FlowMaxOps\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.CBWH004TT\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"CBWH004TT\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.894\",\n  \"modified\" : \"2021-09-29T01:48:12.537\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"CBWH003TT\",\n  \"description\" : \"H3 Daily Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.H03TWL01FI01QFL.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"H3MaxFlowOp\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.CBWH003TT\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"CBWH003TT\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.896\",\n  \"modified\" : \"2021-09-22T02:24:05.737\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"CBWH005TT\",\n  \"description\" : \"H5 Daily Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.H05TWL01FI01QFL.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"H5FlowMaxOps\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.CBWH005TT\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"CBWH005TT\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.898\",\n  \"modified\" : \"2023-08-03T01:12:33.949\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"CBWG006TT\",\n  \"description\" : \"G6 Daily Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"MDPH.MDPSCDA.CBWG006TT.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"G6MaxFlowOps\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.CBWG006TT\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"CBWG006TT\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.900\",\n  \"modified\" : \"2019-12-10T17:02:59.901\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"STPTWL1TTVOLFLAG\",\n  \"description\" : \"Shades Mill Discharge Daily Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.STPTWL01FI01QFL.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"ShadesMillMaxFlowOps\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.STPTWL1TTVOLFLAG\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"STPTWL1TTVOLFLAG\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.902\",\n  \"modified\" : \"2021-05-03T13:56:54.524\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"PTPTWL1TTVOLFLAG\",\n  \"description\" : \"Pinebush Discharge Daily Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.PTPTWL01FI01QFL.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"PinebushMaxFlowOps\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.PTPTWL1TTVOLFLAG\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"PTPTWL1TTVOLFLAG\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.904\",\n  \"modified\" : \"2021-10-06T00:08:25.329\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"TTPTWL1TTVOLFLAG\",\n  \"description\" : \"Turnbull Discharge Daily Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.TTPTWL01FI01QFL.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"TurnbullMaxFlowOps\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.TTPTWL1TTVOLFLAG\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"TTPTWL1TTVOLFLAG\",\n  \"meta\" : null,\n  \"scale\" : 0,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.906\",\n  \"modified\" : \"2022-05-17T03:09:45.282\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"WHPWY_RTQRN\",\n  \"description\" : \"Wellesley Combined Run Time\",\n  \"engUnits\" : \"HRS\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"SJPH.SJPSCDA.WHPWY01RTQRN.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"98034081-9e5c-4fa4-a37c-24b7f64bb4a6\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ {\n      \"name\" : \"second\",\n      \"pattern\" : \"\",\n      \"query\" : \"SJPH.SJPSCDA.WHPWY05RTQRN.F_CV:periodTotal:P1D\",\n      \"type\" : \"tag\"\n    }, {\n      \"name\" : \"third\",\n      \"pattern\" : \"\",\n      \"query\" : \"SJPH.SJPSCDA.WHPWY06RTQRN.F_CV:periodTotal:P1D\",\n      \"type\" : \"tag\"\n    } ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.WHPWY_RTQRN\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"WHPWY_RTQRN\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.908\",\n  \"modified\" : \"2019-12-10T17:02:59.910\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Sum Three Tags\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"98034081-9e5c-4fa4-a37c-24b7f64bb4a6\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"SJPH.SJPSCDA.WHPWY01TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"SJPH.SJPSCDA.WHPWY05TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"second\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"SJPH.SJPSCDA.WHPWY06TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"third\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs){\\n    //Summing the two tags together\\n    pair.a.Value = pair.a.Value + pair.b.Value;\\n}\\n//Repeat same procedure using third input tag\\nTagInputPair tipb = new TagInputPair(__source__, third, 60);\\nfor (DataPair pairb: tipb.pairs){\\n    pairb.a.Value = pairb.a.Value + pairb.b.Value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2009-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"98034081-9e5c-4fa4-a37c-24b7f64bb4a6\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2009-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"STCSC_RTQRN\",\n  \"description\" : \"St Clements Combined Run Time\",\n  \"engUnits\" : \"HRS\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.STCW00020000QRN.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"2db4fc9b-65cf-4e91-841a-a245ed9bc1a4\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ {\n      \"name\" : \"second\",\n      \"pattern\" : \"\",\n      \"query\" : \"WATH.MTPSVR2.STCW00030000QRN.F_CV:periodTotal:P1D\",\n      \"type\" : \"tag\"\n    } ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.STCSC_RTQRN\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"STCSC_RTQRN\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.911\",\n  \"modified\" : \"2024-07-26T13:34:10.371\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Sum Two Tags\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"2db4fc9b-65cf-4e91-841a-a245ed9bc1a4\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"SJPH.SJPSCDA.CPSC003TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"SJPH.SJPSCDA.CPSC004TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"second\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs) {\\n    //Summing the two tags together\\n    pair.a.value = pair.a.value + pair.b.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2009-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"2db4fc9b-65cf-4e91-841a-a245ed9bc1a4\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2009-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"LINL_RTQRN\",\n  \"description\" : \"Linwood Combined Run Time\",\n  \"engUnits\" : \"HRS\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"SJPH.SJPSCDA.LINL001RTQRN.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"2db4fc9b-65cf-4e91-841a-a245ed9bc1a4\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ {\n      \"name\" : \"second\",\n      \"pattern\" : \"\",\n      \"query\" : \"SJPH.SJPSCDA.LINL002RTQRN.F_CV:periodTotal:P1D\",\n      \"type\" : \"tag\"\n    } ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.LINL_RTQRN\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"LINL_RTQRN\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.913\",\n  \"modified\" : \"2019-12-10T17:02:59.914\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Sum Two Tags\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"2db4fc9b-65cf-4e91-841a-a245ed9bc1a4\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"SJPH.SJPSCDA.CPSC003TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"SJPH.SJPSCDA.CPSC004TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"second\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs) {\\n    //Summing the two tags together\\n    pair.a.value = pair.a.value + pair.b.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2009-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"2db4fc9b-65cf-4e91-841a-a245ed9bc1a4\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2009-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"HEPHD_RTQRN\",\n  \"description\" : \"Heidelberg Combined Run Time\",\n  \"engUnits\" : \"HRS\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"SJPH.SJPSCDA.HEPHD01RTQRN.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"2db4fc9b-65cf-4e91-841a-a245ed9bc1a4\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ {\n      \"name\" : \"second\",\n      \"pattern\" : \"\",\n      \"query\" : \"SJPH.SJPSCDA.HEPHD02RTQRN.F_CV:periodTotal:P1D\",\n      \"type\" : \"tag\"\n    } ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.HEPHD_RTQRN\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"HEPHD_RTQRN\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.916\",\n  \"modified\" : \"2019-12-10T17:02:59.917\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Sum Two Tags\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"2db4fc9b-65cf-4e91-841a-a245ed9bc1a4\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"SJPH.SJPSCDA.CPSC003TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"SJPH.SJPSCDA.CPSC004TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"second\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs) {\\n    //Summing the two tags together\\n    pair.a.value = pair.a.value + pair.b.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2009-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"2db4fc9b-65cf-4e91-841a-a245ed9bc1a4\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2009-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"LBMIL01TT.F_CV\",\n  \"description\" : \"Lloyd Brown Flow Total Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"@.KWCR_LBMIL01TT.F_CV_PREP:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.LBMIL01TT.F_CV\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"LBMIL01TT.F_CV\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.918\",\n  \"modified\" : \"2019-12-10T17:02:59.919\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"KWCR_LBMIL01TT.F_CV_PREP\",\n  \"description\" : \"Lloyd Brown Classic Historian Totalizer Prep\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_LBMIL01TT.F_CV:sample:PT2M\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.KWCR_LBMIL01TT.F_CV_PREP\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"KWCR_LBMIL01TT.F_CV_PREP\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.920\",\n  \"modified\" : \"2019-12-10T17:02:59.921\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Classic Historian Totalizer Prep Rule\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"KWCRH.KWCR_KIWK050TT.F_CV:sample:PT2M\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Initialize local variable prevValue with the first value in the input array\\nBigDecimal prevValue = __source__.first;\\n//Iterate through each element of the input array\\nforeach(element:__source__.array){\\n    //If the value of the array element is less than 1\\n    if(element.value<1){\\n        //Set the quality of the element to 0\\n        element.quality=0;\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //If the difference between the current value and the previous value\\n    //is greater than 500\\n    if((element.value - prevValue)>500 || (element.value-prevValue<-500)){\\n        //Apply the flag \\\"QLTY\\\" to the value\\n        element.addFlag(\\\"QLTY\\\");\\n    }\\n    //Set the value of prevValue to the current element value\\n    prevValue = element.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"ee59d66b-28cb-46fb-a865-be9c70844769\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"ATPA00_RTQRN\",\n  \"description\" : \"Ayr Combined Run Time\",\n  \"engUnits\" : \"HRS\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"MDPH.MDPSCDA.ATPA001RTQRN.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"98034081-9e5c-4fa4-a37c-24b7f64bb4a6\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ {\n      \"name\" : \"second\",\n      \"pattern\" : \"\",\n      \"query\" : \"MDPH.MDPSCDA.ATPA002RTQRN.F_CV:periodTotal:P1D\",\n      \"type\" : \"tag\"\n    }, {\n      \"name\" : \"third\",\n      \"pattern\" : \"\",\n      \"query\" : \"MDPH.MDPSCDA.ATPA003RTQRN.F_CV:periodTotal:P1D\",\n      \"type\" : \"tag\"\n    } ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.ATPA00_RTQRN\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"ATPA00_RTQRN\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.922\",\n  \"modified\" : \"2019-12-10T17:02:59.923\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Sum Three Tags\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"98034081-9e5c-4fa4-a37c-24b7f64bb4a6\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"SJPH.SJPSCDA.WHPWY01TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"SJPH.SJPSCDA.WHPWY05TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"second\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"SJPH.SJPSCDA.WHPWY06TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"third\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs){\\n    //Summing the two tags together\\n    pair.a.Value = pair.a.Value + pair.b.Value;\\n}\\n//Repeat same procedure using third input tag\\nTagInputPair tipb = new TagInputPair(__source__, third, 60);\\nfor (DataPair pairb: tipb.pairs){\\n    pairb.a.Value = pairb.a.Value + pairb.b.Value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2009-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"98034081-9e5c-4fa4-a37c-24b7f64bb4a6\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2009-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"RTPR00_RTQRN\",\n  \"description\" : \"Roseville Combined Run Time\",\n  \"engUnits\" : \"HRS\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_RTPR005RTQRN.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"2db4fc9b-65cf-4e91-841a-a245ed9bc1a4\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ {\n      \"name\" : \"second\",\n      \"pattern\" : \"\",\n      \"query\" : \"KWCRH.KWCR_RTPR006RTQRN.F_CV:periodTotal:P1D\",\n      \"type\" : \"tag\"\n    } ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.RTPR00_RTQRN\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"RTPR00_RTQRN\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.925\",\n  \"modified\" : \"2019-12-10T17:02:59.926\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Sum Two Tags\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"2db4fc9b-65cf-4e91-841a-a245ed9bc1a4\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"SJPH.SJPSCDA.CPSC003TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"SJPH.SJPSCDA.CPSC004TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"second\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs) {\\n    //Summing the two tags together\\n    pair.a.value = pair.a.value + pair.b.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2009-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"2db4fc9b-65cf-4e91-841a-a245ed9bc1a4\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2009-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"BMSBM0_RTQRN\",\n  \"description\" : \"Branchton Combined Run Time\",\n  \"engUnits\" : \"HRS\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"KWCRH.KWCR_BMSBM01RTQRN.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"2db4fc9b-65cf-4e91-841a-a245ed9bc1a4\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ {\n      \"name\" : \"second\",\n      \"pattern\" : \"\",\n      \"query\" : \"KWCRH.KWCR_BMSBM02RTQRN.F_CV:periodTotal:P1D\",\n      \"type\" : \"tag\"\n    } ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.BMSBM0_RTQRN\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"BMSBM0_RTQRN\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.927\",\n  \"modified\" : \"2019-12-10T17:02:59.928\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Sum Two Tags\",\n  \"description\" : \"\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"2db4fc9b-65cf-4e91-841a-a245ed9bc1a4\",\n  \"constant\" : [ ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"SJPH.SJPSCDA.CPSC003TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"SJPH.SJPSCDA.CPSC004TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"second\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs) {\\n    //Summing the two tags together\\n    pair.a.value = pair.a.value + pair.b.value;\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2009-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"2db4fc9b-65cf-4e91-841a-a245ed9bc1a4\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2009-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"SJPH.SJPSCDA.MYPRES0CARCT.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap Maryhill WTP Reservoir CT Calculation\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"SJPH.SJPSCDA.MYPRES0CARCT.F_CV:rawByTime:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MaxGapMinutes\",\n      \"constant\" : \"MaxGapMinutes\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.SJPH.SJPSCDA.MYPRES0CARCT.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"SJPH.SJPSCDA.MYPRES0CARCT.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.929\",\n  \"modified\" : \"2019-12-10T17:02:59.930\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MTPH.MTPSCDA.WMHCFR3AIQ01.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap West Montrose Post-Filter Free Chlorine\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"MTPH.MTPSCDA.WMHCFR3AIQ01.F_CV:rawByTime:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MaxGapMinutes\",\n      \"constant\" : \"MaxGapMinutes\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MTPH.MTPSCDA.WMHCFR3AIQ01.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MTPH.MTPSCDA.WMHCFR3AIQ01.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.931\",\n  \"modified\" : \"2019-12-10T17:02:59.932\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MTPH.MTPSCDA.MTPFL01NIQ01.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap Mannheim Filter 1 Effluent Turbidity\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR1.MTPFL01NIQ01.F_CV:raw:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MaxGapMinutes\",\n      \"constant\" : \"MaxGapMinutes\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MTPH.MTPSCDA.MTPFL01NIQ01.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MTPH.MTPSCDA.MTPFL01NIQ01.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.934\",\n  \"modified\" : \"2020-12-09T15:34:00.942\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MTPH.MTPSCDA.MTPUV01UVQ02.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap Mannheim UV#1 Actual Dosage\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR1.MTPUV0010000VST.F_CV:raw:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MaxGapMinutes\",\n      \"constant\" : \"MaxGapMinutes\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MTPH.MTPSCDA.MTPUV01UVQ02.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MTPH.MTPSCDA.MTPUV01UVQ02.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.936\",\n  \"modified\" : \"2020-12-09T15:34:37.125\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MTPH.MTPSCDA.M4PZON4AIQ01.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap Mannheim Z4 Discharge Total Chlorine\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR1.M4PZON4AIQ01.F_CV:raw:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MaxGapMinutes\",\n      \"constant\" : \"MaxGapMinutes\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MTPH.MTPSCDA.M4PZON4AIQ01.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MTPH.MTPSCDA.M4PZON4AIQ01.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.938\",\n  \"modified\" : \"2020-12-09T15:30:03.318\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MTPH.MTPSCDA.M5PZON5AIQ01.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap Mannheim Z5 Discharge Total Chlorine\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR1.M5PZON5AIQ01.F_CV:raw:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MTPH.MTPSCDA.M5PZON5AIQ01.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MTPH.MTPSCDA.M5PZON5AIQ01.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.940\",\n  \"modified\" : \"2020-12-09T15:30:27.037\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MTPH.MTPSCDA.M6PZON6AIQ01.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap Mannheim Z6 Discharge Total Chlorine\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR1.M6PZON6AIQ01.F_CV:raw:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MaxGapMinutes\",\n      \"constant\" : \"MaxGapMinutes\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MTPH.MTPSCDA.M6PZON6AIQ01.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MTPH.MTPSCDA.M6PZON6AIQ01.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.943\",\n  \"modified\" : \"2020-12-09T15:30:48.385\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MTPH.MTPSCDA.KIWK023AIQ01.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap K23 Discharge Free Chlorine\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR3.K23TWL01RF01QVA.F_CV:raw:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MTPH.MTPSCDA.KIWK023AIQ01.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MTPH.MTPSCDA.KIWK023AIQ01.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.945\",\n  \"modified\" : \"2024-03-26T20:54:38.321\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MTPH.MTPSCDA.KIWK024AIQ01.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap K24 Discharge Free Chlorine\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR3.K24TWL01RF01QVA.F_CV:raw:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MTPH.MTPSCDA.KIWK024AIQ01.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MTPH.MTPSCDA.KIWK024AIQ01.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.948\",\n  \"modified\" : \"2023-06-10T16:25:33.798\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MTPH.MTPSCDA.KIWK026AIQ01.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap K26 Discharge Free Chlorine\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR3.K26TWL01RF01QVA.F_CV:raw:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MaxGapMinutes\",\n      \"constant\" : \"MaxGapMinutes\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MTPH.MTPSCDA.KIWK026AIQ01.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MTPH.MTPSCDA.KIWK026AIQ01.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.950\",\n  \"modified\" : \"2023-06-10T16:26:06.187\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MTPH.MTPSCDA.KIWCFR1AIQ01.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap K34 Reservoir Free Chlorine\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR3.K34TWR01RF01QVA.F_CV:raw:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MaxGapMinutes\",\n      \"constant\" : \"MaxGapMinutes\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MTPH.MTPSCDA.KIWCFR1AIQ01.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MTPH.MTPSCDA.KIWCFR1AIQ01.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.952\",\n  \"modified\" : \"2023-06-10T16:46:27.310\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MTPH.MTPSCDA.KIWK050AIQ01.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap K50 Discharge Free Chlorine\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR3.K50W0050RF01QVA.F_CV:raw:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MTPH.MTPSCDA.KIWK050AIQ01.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MTPH.MTPSCDA.KIWK050AIQ01.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.955\",\n  \"modified\" : \"2024-01-11T01:18:36.731\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MTPH.MTPSCDA.SSPCFR2AIQ01.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap Strange St Res Inlet Free Chlorine\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR3.SSPFWL01RF02QVA.F_CV:raw:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MaxGapMinutes\",\n      \"constant\" : \"MaxGapMinutes\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MTPH.MTPSCDA.SSPCFR2AIQ01.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MTPH.MTPSCDA.SSPCFR2AIQ01.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.957\",\n  \"modified\" : \"2023-06-10T16:41:59.198\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"SJPH.SJPSCDA.CGSRES0CARCT.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap Conestoga Golf Reservoir CT Calculation\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"SJPH.SJPSCDA.CGSRES0CARCT.F_CV:rawByTime:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MaxGapMinutes\",\n      \"constant\" : \"MaxGapMinutes\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.SJPH.SJPSCDA.CGSRES0CARCT.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"SJPH.SJPSCDA.CGSRES0CARCT.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.959\",\n  \"modified\" : \"2019-12-10T17:02:59.960\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"SJPH.SJPSCDA.CPSRES1CARCT.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap Conestoga Plains Reservoir CT Calculation\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"SJPH.SJPSCDA.CPSRES1CARCT.F_CV:rawByTime:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MaxGapMinutes\",\n      \"constant\" : \"MaxGapMinutes\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.SJPH.SJPSCDA.CPSRES1CARCT.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"SJPH.SJPSCDA.CPSRES1CARCT.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.961\",\n  \"modified\" : \"2019-12-10T17:02:59.962\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MDPH.MDPSCDA.ATPCFR1AIQ01.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap Ayr Discharge Free Chlorine\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.APSTWL01RF01QVA.F_CV:raw:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MaxGapMinutes\",\n      \"constant\" : \"MaxGapMinutes\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MDPH.MDPSCDA.ATPCFR1AIQ01.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MDPH.MDPSCDA.ATPCFR1AIQ01.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.963\",\n  \"modified\" : \"2023-05-31T02:16:32.228\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MTPH.MTPSCDA.NDPCFR1AIQ01.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap New Dundee Discharge Free Chlorine\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"MTPH.MTPSCDA.NDPCFR1AIQ01.F_CV:rawByTime:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MaxGapMinutes\",\n      \"constant\" : \"MaxGapMinutes\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MTPH.MTPSCDA.NDPCFR1AIQ01.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MTPH.MTPSCDA.NDPCFR1AIQ01.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.966\",\n  \"modified\" : \"2019-12-10T17:02:59.967\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MTPH.MTPSCDA.FGSCFR1AIQ01.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap Foxboro Discharge Free Chlorine\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR3.FGSTWL01RF01QVA.F_CV:raw:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MaxGapMinutes\",\n      \"constant\" : \"MaxGapMinutes\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MTPH.MTPSCDA.FGSCFR1AIQ01.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MTPH.MTPSCDA.FGSCFR1AIQ01.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.968\",\n  \"modified\" : \"2024-03-01T19:14:31.768\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MDPH.MDPSCDA.MDPCFR3AIQ01.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap Middleton Res. Outlet Free Chlorine\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.MDPCFR3AIQ01.F_CV:raw:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MDPH.MDPSCDA.MDPCFR3AIQ01.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MDPH.MDPSCDA.MDPCFR3AIQ01.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.970\",\n  \"modified\" : \"2021-12-17T04:22:55.699\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MDPH.MDPSCDA.CBWG004AIQ01.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap G4 Discharge Free Chlorine\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.CBWG004AIQ01.F_CV:raw:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MaxGapMinutes\",\n      \"constant\" : \"MaxGapMinutes\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MDPH.MDPSCDA.CBWG004AIQ01.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MDPH.MDPSCDA.CBWG004AIQ01.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.973\",\n  \"modified\" : \"2021-12-17T04:22:01.697\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MDPH.MDPSCDA.CBWG005AIQ01.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap G5 Discharge Free Chlorine\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.G05TWL01RF01QVA.F_CV:raw:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MaxGapMinutes\",\n      \"constant\" : \"MaxGapMinutes\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MDPH.MDPSCDA.CBWG005AIQ01.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MDPH.MDPSCDA.CBWG005AIQ01.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.975\",\n  \"modified\" : \"2021-10-12T23:34:09.046\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MDPH.MDPSCDA.CBWG009AIQ01.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap G9 Discharge Free Chlorine\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.G09TWL01RF01QVA.F_CV:raw:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MaxGapMinutes\",\n      \"constant\" : \"MaxGapMinutes\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MDPH.MDPSCDA.CBWG009AIQ01.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MDPH.MDPSCDA.CBWG009AIQ01.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.977\",\n  \"modified\" : \"2023-07-19T15:02:56.076\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MDPH.MDPSCDA.STPCFR2AIQ01.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap Shades Discharge Free Chlorine\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.STPTWL01RF01QVA.F_CV:raw:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MaxGapMinutes\",\n      \"constant\" : \"MaxGapMinutes\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MDPH.MDPSCDA.STPCFR2AIQ01.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MDPH.MDPSCDA.STPCFR2AIQ01.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.979\",\n  \"modified\" : \"2021-05-03T13:53:37.358\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MDPH.MDPSCDA.TTPCFR2AIQ01.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap Turnbull Discharge Free Chlorine\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.TTPCFR2AIQ01.F_CV:raw:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MaxGapMinutes\",\n      \"constant\" : \"MaxGapMinutes\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MDPH.MDPSCDA.TTPCFR2AIQ01.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MDPH.MDPSCDA.TTPCFR2AIQ01.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.982\",\n  \"modified\" : \"2021-12-17T04:24:40.823\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap Pinebush Discharge Free Chlorine\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.PTPTWL01RF01QVA.F_CV:raw:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MaxGapMinutes\",\n      \"constant\" : \"MaxGapMinutes\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.984\",\n  \"modified\" : \"2021-12-17T04:24:12.038\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"MTPH.MTPSCDA.WSPCTR1AIQ01.F_CV_esrMaxGapTime\",\n  \"description\" : \"Time of largest daily data gap William St Discharge Total Chlorine\",\n  \"engUnits\" : \"DateTime\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"MTPH.MTPSCDA.WSPCTR1AIQ01.F_CV:rawByTime:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MaxGapMinutes\",\n      \"constant\" : \"MaxGapMinutes\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.MTPH.MTPSCDA.WSPCTR1AIQ01.F_CV_esrMaxGapTime\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"MTPH.MTPSCDA.WSPCTR1AIQ01.F_CV_esrMaxGapTime\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.986\",\n  \"modified\" : \"2019-12-10T17:02:59.987\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"esrMaxGapTime Rule\",\n  \"description\" : \"Returns the time corresponding to the beginning of the longest data gap in a day\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"constant\" : [ \"MaxGapMinutes\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MDPH.MDPSCDA.PTPCFR2AIQ01.F_CV:rawByTime:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P3D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"Date lastGood = __source__.array[0].time;\\nlong maxGap=0;\\nString maxGapTime = null;\\nDate currentDay =  null;\\nint currentDayOfMonth = 0;\\nboolean isLastGood = true;\\nDate badStart = null;\\nList results = new ArrayList();\\nfor(Data data: __source__.data) {\\n    if (data.good) {\\n        Calendar cal2 = GregorianCalendar.getInstance();\\n        cal2.setTime(data.time);\\n        int dom2 = cal2.get(Calendar.DAY_OF_MONTH);\\n        // detect day change and reset...\\n        if (currentDayOfMonth == 0 || currentDayOfMonth != dom2) {\\n            if (currentDayOfMonth != 0 && maxGapTime != null) {\\n                results.add(new Data(currentDay, maxGapTime, 100));\\n            }\\n            currentDayOfMonth = dom2;\\n            currentDay = data.time;\\n            maxGapTime = null;\\n            maxGap = 0;\\n            lastGood = data.time;\\n            isLastGood = true;\\n        }\\n        if(currentDayOfMonth == dom2){\\n            isLastGood = true;\\n        }\\n        // determine gap..\\n        Date badEnd = data.time;\\n        //context.trace(\\\"Bad End: \\\"+badEnd);\\n        long l = badEnd.getTime() - lastGood.getTime();\\n        if (l > maxGap && l >= $(MaxGapMinutes) * 60 * 1000) {\\n            maxGap = l;\\n            SimpleDateFormat df =  new SimpleDateFormat(\\\"yyyy-MMM-dd HH:mm:ss\\\");\\n            maxGapTime = df.format(lastGood);\\n            //context.trace(\\\"MaxGapTime found: \\\"+maxGapTime);\\n        }\\n        if (isLastGood) {\\n            lastGood = data.time;\\n        }\\n    }\\n    else {\\n        isLastGood = false;\\n    }\\n    context.trace(\\\"LastGood:\\\" +lastGood);\\n}\\nif (currentDayOfMonth != 0 && maxGapTime != null) {\\n    results.add(new Data(currentDay, maxGapTime, 100));\\n}\\nfor (Data d: results) {\\n    //context.trace(d);\\n}\\n__source__.replace(results);\\n\",\n    \"version\" : 1,\n    \"start\" : \"2011-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"5c52f953-04bd-4d39-9569-b2d44eca3cd3\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2011-01-01T14:01:54.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"RAPP009TT\",\n  \"description\" : \"P9 Daily Volume Max Flagging\",\n  \"engUnits\" : \"m^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR2.RAPW0009FI01QFL.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"P9MaxFlow\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.RAPP009TT\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"RAPP009TT\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.988\",\n  \"modified\" : \"2022-01-06T19:26:42.584\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"GBPKBVOLFLAG\",\n  \"description\" : \"Greenbrook Discharge Flow With Min/Max and 10% Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR3.GBPTWL01FI01QFL.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"TenPercent\",\n      \"constant\" : \"TenPercent\"\n    }, {\n      \"name\" : \"HeidelbergMinFlow\",\n      \"constant\" : \"HeidelbergMinFlow\"\n    }, {\n      \"name\" : \"HeidelbergMaxFlow\",\n      \"constant\" : \"GBPMaxFlow\"\n    } ],\n    \"inputRef\" : [ {\n      \"name\" : \"second\",\n      \"pattern\" : \"\",\n      \"query\" : \"@.GBPRWT1TT:first:P1D\",\n      \"type\" : \"tag\"\n    } ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.GBPKBVOLFLAG\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"GBPKBVOLFLAG\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.994\",\n  \"modified\" : \"2023-06-10T16:29:47.554\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Min/Max and Relative Difference Flagging\",\n  \"description\" : \"Flags primary input for min and max. Compares primary to secondary tag and applies flag if relative diff. is greater than specified %.\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\",\n  \"constant\" : [ \"HeidelbergMaxFlow\", \"HeidelbergMinFlow\", \"TenPercent\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"SJPH.SJPSCDA.HEPTWL1TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"@.HEPWELLTT.F_CV:first:P1D\",\n    \"name\" : \"second\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Primary loop for source tag\\nfor (Data PD: __source__.array){\\n    //Check if above maximum\\n    if(PD.value > $(HeidelbergMaxFlow)) {\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n    //Check if below minimum\\n    if (PD.value < $(HeidelbergMinFlow)) {\\n        PD.addFlag(\\\"MIN\\\");\\n    }\\n}\\n//Initialize variables to hold relative difference calculations\\nBigDecimal relDiff = 0;\\nBigDecimal relDiff2 = 0;\\n//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs){\\n    //Calculate difference relative to first value\\n    if(pair.a.value!=0){\\n        relDiff = ((pair.a.value-pair.b.value)/pair.a.value);\\n    }\\n    if(pair.b.value!=0){\\n        //Calculate difference relative to second value\\n        relDiff2 = ((pair.a.value-pair.b.value)/pair.b.value);\\n    }\\n    //Flag value if relative difference is greater than 10%\\n    if(relDiff > 0.10||relDiff < -0.10||relDiff2 > 0.10||relDiff2 < -0.10)\\n        pair.a.addFlag(\\\"OUT\\\");\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  }, {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal heidelbergMaxFlow = HeidelbergMaxFlow.getValue(PD);\\n    context.trace(HeidelbergMaxFlow.getValue(PD));\\n    if(PD.value > heidelbergMaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n    //If the value of the element is below threshold\\n    BigDecimal heidelbergMinFlow = HeidelbergMinFlow.getValue(PD);\\n    if (PD.value < heidelbergMinFlow) {\\n        //Apply \\\"MIN\\\" flag to data element\\n        PD.addFlag(\\\"MIN\\\");\\n    }\\n}\\n//Initialize variables to hold relative difference calculations\\nBigDecimal relDiff = 0;\\n//BigDecimal relDiff2 = 0;\\n//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs){\\n    //Calculate difference relative to first value\\n    if(pair.a.value!=0){\\n        relDiff = ((pair.a.value-pair.b.value)/pair.a.value);\\n        context.trace(relDiff);\\n        BigDecimal tenPercent = TenPercent.getValue(pair);\\n        if(Math.abs(relDiff) > tenPercent){\\n            pair.a.addFlag(\\\"OUT\\\");\\n        }\\n    }\\n}\\n\",\n    \"version\" : 2,\n    \"start\" : \"2015-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : false\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\",\n  \"owner\" : \"ralbasel@regionofwaterloo.ca\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"GBPRWT1TT\",\n  \"description\" : \"Greenbrook Inlet 2 Daily Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"WATH.MTPSVR3.GBFRWL01FI01QFL.F_CV:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"GBPMaxFlow\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.GBPRWT1TT\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"GBPRWT1TT\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:02:59.997\",\n  \"modified\" : \"2024-07-18T15:24:17.246\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"GBPK00TT\",\n  \"description\" : \"Greenbrook Inlet 1 Combined Well Flow with Max Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"@.GBPKINLET1TT:first:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"GBPMaxFlow\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.GBPK00TT\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"GBPK00TT\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:03:00.000\",\n  \"modified\" : \"2019-12-10T17:03:00.001\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"PKPRES0TT\",\n  \"description\" : \"Parkway Daily Flow Maximum Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"@.KWCRH.KWCR_PKPRES0TT.F_CV_PREP:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"MV3MaxFlow\",\n      \"constant\" : \"PKPMaxFlow\"\n    } ],\n    \"inputRef\" : [ ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.PKPRES0TT\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"PKPRES0TT\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:03:00.003\",\n  \"modified\" : \"2019-12-10T17:03:00.004\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Flow Total Flagging (Maximum only)\",\n  \"description\" : \"Flags only values in exceedence of maximum\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"constant\" : [ \"MV3MaxFlow\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"MTPH.MTPSCDA.KIWK021TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal mV3MaxFlow = MV3MaxFlow.getValue(PD);\\n    if(PD.value > mV3MaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2014-10-10T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"d7ec47ed-6197-47cd-88fd-f2596fe64283\",\n  \"owner\" : \"admin@eramosa.com\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]},{"item":"{\n  \"name\" : \"PKPKB00TTVOLFLAG\",\n  \"description\" : \"Parkway Daily Discharge With Min/Max 10% Flagging\",\n  \"engUnits\" : \"M^3\",\n  \"collectionType\" : \"polled:1m\",\n  \"sampleType\" : \"ANALOG\",\n  \"formula\" : null,\n  \"source\" : \"@.KWCRH.KWCR_PKPKB00TT.F_CV_PREP:periodTotal:P1D\",\n  \"alternateSource\" : null,\n  \"tagPlusSpec\" : [ ],\n  \"ruleSpec\" : [ {\n    \"ruleRef\" : [ {\n      \"calc\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\"\n    } ],\n    \"constantRef\" : [ {\n      \"name\" : \"TenPercent\",\n      \"constant\" : \"TenPercent\"\n    }, {\n      \"name\" : \"HeidelbergMinFlow\",\n      \"constant\" : \"HeidelbergMinFlow\"\n    }, {\n      \"name\" : \"HeidelbergMaxFlow\",\n      \"constant\" : \"PKPMaxFlow\"\n    } ],\n    \"inputRef\" : [ {\n      \"name\" : \"second\",\n      \"pattern\" : \"\",\n      \"query\" : \"@.PKPRES0TT:first:P1D\",\n      \"type\" : \"tag\"\n    } ],\n    \"id\" : null\n  } ],\n  \"validationSpec\" : null,\n  \"constraint\" : null,\n  \"descriptor\" : [ ],\n  \"sourceDescription\" : \"\",\n  \"sourceEngUnits\" : \"\",\n  \"param\" : [ ],\n  \"metadata\" : \"\",\n  \"location\" : null,\n  \"sourceLocation\" : null,\n  \"provider\" : null,\n  \"id\" : \"@.PKPKB00TTVOLFLAG\",\n  \"altId\" : \"\",\n  \"providerId\" : \"@\",\n  \"providerAltId\" : \"\",\n  \"defaultMode\" : null,\n  \"actual\" : \"PKPKB00TTVOLFLAG\",\n  \"meta\" : null,\n  \"scale\" : -1,\n  \"roundingMode\" : \"HALF_EVEN\",\n  \"accumulating\" : false,\n  \"input\" : false,\n  \"inputType\" : \"xs:decimal\",\n  \"validated\" : false,\n  \"stored\" : false,\n  \"group\" : \"\",\n  \"created\" : \"2019-12-10T17:03:00.005\",\n  \"modified\" : \"2021-03-11T01:25:00.412\",\n  \"cacheable\" : false,\n  \"lastUpdate\" : null,\n  \"active\" : true,\n  \"enabled\" : true,\n  \"favourite\" : null\n}","type":"TagSpec","base64":null,"dependencies":[{"item":"{\n  \"name\" : \"Min/Max and Relative Difference Flagging\",\n  \"description\" : \"Flags primary input for min and max. Compares primary to secondary tag and applies flag if relative diff. is greater than specified %.\",\n  \"schedule\" : \"* * * * *\",\n  \"lastRunMessage\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\",\n  \"constant\" : [ \"HeidelbergMaxFlow\", \"HeidelbergMinFlow\", \"TenPercent\" ],\n  \"outputRef\" : [ ],\n  \"input\" : [ {\n    \"value\" : \"SJPH.SJPSCDA.HEPTWL1TT.F_CV:periodTotal:P1D\",\n    \"name\" : \"__source__\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  }, {\n    \"value\" : \"@.HEPWELLTT.F_CV:first:P1D\",\n    \"name\" : \"second\",\n    \"type\" : \"tag\",\n    \"description\" : null,\n    \"startOffset\" : \"-PT0S\",\n    \"duration\" : \"P1D\",\n    \"useCache\" : false,\n    \"regex\" : false,\n    \"ruleSource\" : false,\n    \"metadata\" : null\n  } ],\n  \"output\" : [ ],\n  \"code\" : [ {\n    \"value\" : \"//Primary loop for source tag\\nfor (Data PD: __source__.array){\\n    //Check if above maximum\\n    if(PD.value > $(HeidelbergMaxFlow)) {\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n    //Check if below minimum\\n    if (PD.value < $(HeidelbergMinFlow)) {\\n        PD.addFlag(\\\"MIN\\\");\\n    }\\n}\\n//Initialize variables to hold relative difference calculations\\nBigDecimal relDiff = 0;\\nBigDecimal relDiff2 = 0;\\n//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs){\\n    //Calculate difference relative to first value\\n    if(pair.a.value!=0){\\n        relDiff = ((pair.a.value-pair.b.value)/pair.a.value);\\n    }\\n    if(pair.b.value!=0){\\n        //Calculate difference relative to second value\\n        relDiff2 = ((pair.a.value-pair.b.value)/pair.b.value);\\n    }\\n    //Flag value if relative difference is greater than 10%\\n    if(relDiff > 0.10||relDiff < -0.10||relDiff2 > 0.10||relDiff2 < -0.10)\\n        pair.a.addFlag(\\\"OUT\\\");\\n}\\n\",\n    \"version\" : 1,\n    \"start\" : \"2005-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : true\n  }, {\n    \"value\" : \"//Iterate through each element of the input array\\nfor (Data PD: __source__.array){\\n    //If the value of the element is above threshold\\n    BigDecimal heidelbergMaxFlow = HeidelbergMaxFlow.getValue(PD);\\n    context.trace(HeidelbergMaxFlow.getValue(PD));\\n    if(PD.value > heidelbergMaxFlow) {\\n        //Apply \\\"MAX\\\" flag to data element\\n        PD.addFlag(\\\"MAX\\\");\\n    }\\n    //If the value of the element is below threshold\\n    BigDecimal heidelbergMinFlow = HeidelbergMinFlow.getValue(PD);\\n    if (PD.value < heidelbergMinFlow) {\\n        //Apply \\\"MIN\\\" flag to data element\\n        PD.addFlag(\\\"MIN\\\");\\n    }\\n}\\n//Initialize variables to hold relative difference calculations\\nBigDecimal relDiff = 0;\\n//BigDecimal relDiff2 = 0;\\n//Tag pair of primary and secondary tag\\nTagInputPair tip = new TagInputPair(__source__, second, 60);\\n//Loop to run through all of the tag data\\nfor (DataPair pair: tip.pairs){\\n    //Calculate difference relative to first value\\n    if(pair.a.value!=0){\\n        relDiff = ((pair.a.value-pair.b.value)/pair.a.value);\\n        context.trace(relDiff);\\n        BigDecimal tenPercent = TenPercent.getValue(pair);\\n        if(Math.abs(relDiff) > tenPercent){\\n            pair.a.addFlag(\\\"OUT\\\");\\n        }\\n    }\\n}\\n\",\n    \"version\" : 2,\n    \"start\" : \"2015-01-01T00:00:00.000\",\n    \"end\" : null,\n    \"inputs\" : \"\",\n    \"outputs\" : \"\",\n    \"language\" : \"mvel\",\n    \"activated\" : false,\n    \"verified\" : true,\n    \"enabled\" : false\n  } ],\n  \"mapping\" : [ ],\n  \"id\" : \"412fd560-fdca-4a25-9fc9-162bd1ae4feb\",\n  \"owner\" : \"ralbasel@regionofwaterloo.ca\",\n  \"jsEngine\" : \"GRAAL\",\n  \"workerTimeLimit\" : \"PT1H\",\n  \"lastRun\" : \"2005-01-01T00:00:00.000\",\n  \"enabled\" : true,\n  \"type\" : \"RULE\"\n}","type":"Calculation","base64":null,"dependencies":[]}]}]